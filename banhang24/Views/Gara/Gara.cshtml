@{
    Layout = null;
}
@using System.Web.Optimization
@using banhang24.AppCache
@using banhang24.Hellper

<!DOCTYPE html>
<html lang="vi">
<head>
    <title>Gara- Xử lý hóa đơn, báo giá</title>
    <link href="~/Content/images/open24.vn.png" type="image/gif" rel="icon">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="@Html.WriteRenderFile(Styles.Url("~/Content/CssFramework"))" rel="stylesheet" />
    <link href="@Html.WriteRenderFile(Styles.Url("~/Content/Open24Css"))" rel="stylesheet" />
    <script src="@Html.WriteRenderFile(Scripts.Url("~/bundles/JsFramework"))" type="text/javascript"></script>
    <script src="@Html.WriteRenderFile(Scripts.Url("~/bundles/JsStatic"))" type="text/javascript"></script>
    <link href="@Url.ContentVersioned("~/Content/Gara.css")" rel="stylesheet" />
    <link href="@Url.ContentVersioned("~/Content/Gara.Responsive.css")" rel="stylesheet" />
    <style>

        .flex-between {
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap
        }

        .op-hoadon-thongtinkhac > div > div {
            padding-left: 130px;
            text-align: left
        }

        .open > .dropdown-menu {
            display: block !important;
        }

        .op-dropdown-menu-left {
            left: initial;
            right: 0;
        }

        :root {
            --input-range: 100px;
        }

        .gara-col-left.bill-main.more {
            height: calc(100vh - 50px);
        }

        .op-hoadon-list {
            transition: all 0.4s ease;
            overflow: auto;
            height: calc(100% - 400px)
        }

        .gara-col-left.bill-main.less .op-hoadon-list {
            height: calc(100% - 60px);
        }

        .gara-col-left.bill-main.more .op-hoadon-list {
            height: calc(100% - 400px)
        }

        .gara-catalogies.gara-return {
            transition: all 0.4s ease;
            bottom: 0;
        }

        .op-hoadon-quanlity > div input {
            max-width: 100%;
        }

        .op-js-css-toggle-option {
            width: 60px;
            display: flex;
            align-items: center;
            justify-content: space-around;
            position: relative;
        }

            .op-js-css-toggle-option a {
                width: 30px;
                display: flex;
                align-items: center;
                justify-content: center;
                color: black;
                font-size: 12px;
                transition: all 0.4s ease;
                z-index: 2;
            }

            .op-js-css-toggle-option:before {
                content: '';
                height: 30px;
                width: 30px;
                border-radius: 5px;
                background: var(--color-primary);
                position: absolute;
                z-index: 1;
                left: 0;
                transition: left 0.4s ease;
            }

            .op-js-css-toggle-option.op-js-toggle-2:before {
                left: 30px;
            }

            .op-js-css-toggle-option.op-js-toggle-2 a:nth-child(2) {
                color: white;
            }

            .op-js-css-toggle-option:not(.op-js-toggle-2) a:nth-child(1) {
                color: white;
            }

        .bg-red {
            background: #f44336;
            color: white;
            border: none;
        }

        .bg-green {
            background: #4CAF50;
            color: white;
            border: none;
        }

        body {
            font-size: 13px
        }

        .fillscreen {
            height: calc(100vh - 100px);
        }

        .gara-list-item-left {
            position: relative;
        }

        .gara-bill-result > label {
            font-weight: normal;
        }

        .modal-opened {
            opacity: .7
        }

        html {
            overflow: hidden
        }

        .op-hoadon-quanlity input {
            border: none;
        }

            .op-hoadon-quanlity input:focus, .op-hoadon-quanlity input:hover {
                border-bottom: 1px solid var(--color-primary);
                cursor: text;
            }

        .op-hoadon-thongtinkhac {
            width: 100%;
            display: flex;
            align-items: flex-start;
            justify-content: flex-start;
        }


            .op-hoadon-thongtinkhac > div {
                padding: 1px 2px;
                border-radius: 4px;
                margin-right: 5px;
                text-align: left;
                display: flex;
                justify-content: flex-start;
                align-items: flex-start;
            }

        .op-hoadon-header.op-hoadon-item {
            background: #D9DADC;
            font-weight: bold;
            height: 40px;
            padding-top: 8px;
        }

            .op-hoadon-header.op-hoadon-item .op-hoadon-quanlity {
                text-align: right
            }

        .op-hoadon-infor.op-hanghoa-lohang .op-hoadon-name {
            width: calc(100% - (var(--input-range) *4) - (30px * 7));
            min-width: unset;
        }

        .op-hoadon-name button {
            padding: 0;
            display: flex;
            align-items: center;
            line-height: 18px !important;
            padding: 3px;
            background: rgba(0,0,0,0.05);
            border-radius: 3px;
            color: var(--color-main);
            justify-content: space-between;
            min-width: 50px;
        }

            .op-hoadon-name button:hover, .op-hoadon-name button:focus {
                background: rgba(0,0,0,0.10);
                outline: 1px solid #ccc;
                text-decoration: none;
            }

        .op-hoadon-item:hover .op-hoadon-ghichu {
        }

            .op-hoadon-item:hover .op-hoadon-ghichu > * {
                opacity: 1
            }

        .op-hoadon-ghichu input {
            height: 100%;
            min-height: unset;
            font-size: 10px;
            padding-left: 15px;
            opacity: 0;
        }

        .op-hoadon-ghichu i {
            position: absolute;
            left: 5px;
            top: 3px;
            opacity: 0;
        }

        .op-hoadon-ghichu input:valid {
            opacity: 1;
        }

            .op-hoadon-ghichu input:valid + i {
                opacity: 1;
            }

        .op-hoadon-ghichu input:focus {
            opacity: 1;
        }

            .op-hoadon-ghichu input:focus + i {
                opacity: 1;
            }

        .op-hoadon-item {
            display: flex;
            flex-direction: row;
            justify-content: flex-start;
            align-items: flex-start;
            width: 100%;
            padding: 3px 0;
            flex-wrap: wrap;
            border-bottom: 1px solid #ccc;
            margin-bottom: 5px;
            padding-bottom: 7px;
            position: relative;
        }

        button.op-hoadon-soluong-modify i {
            font-size: 18px;
        }

        .op-hoadon-item:hover {
            box-shadow: 3px 3px 6px rgb(0 0 0 / 15%);
        }


        .op-hoadon-hangkhuyenmai {
            width: 100%;
            display: flex;
            align-items: center;
            flex-wrap: wrap;
        }

        .op-hoadon-hangkhuyenmai-thongtin {
            width: 100%;
        }

        .op-hoadon-infor {
            width: calc(100% - ((var(--input-range) * 3 ) + 60px + ( 30px * 7 )));
            display: flex;
            align-items: center;
            min-width: 375px;
        }

            .op-hoadon-infor.op-hanghoa-lohang {
                width: 100%;
                margin-bottom: 2px;
            }

                .op-hoadon-infor.op-hanghoa-lohang .op-hoadon-name {
                    width: calc(100% - calc((var(--input-range) * 3 ) + 60px + ( 30px * 7 )) - 130px);
                    min-width: unset;
                }

        .op-hoadon-quanlity {
            width: calc((var(--input-range) * 3 ) + 60px + ( 30px * 7 ));
            display: flex;
            align-items: center;
            justify-content: flex-end;
        }

            .op-hoadon-quanlity input {
                text-align: right;
            }

        .op-hoadon-infor > .op-hoadon-stt {
            width: calc( 3ch + 12px);
            margin: 0;
            padding: 3px 5px;
            line-height: 18px;
            display: inline-block;
            align-items: center;
            overflow: hidden;
            white-space: nowrap;
            border: none;
            color: black;
        }

        .op-hoadon-stt > span {
            display: flex;
            height: 18px;
            min-width: 18px;
            border-radius: 15px;
            background: red;
            text-align: center;
            align-items: center;
            justify-content: center;
            line-height: 18px;
        }

        .op-hoadon-infor > .op-hoadon-id {
            width: calc( 12ch + 10px);
            height: 24px;
            border: none;
            line-height: 18px;
            font-weight: bold;
            padding: 3px 5px;
            display: inline-block;
            max-width: 100px;
        }

        .op-hoadon-infor > .op-hoadon-name {
            width: calc(100% - 125px);
            min-height: 24px;
            line-height: 18px;
            display: flex;
            padding: 3px;
            align-items: center;
            justify-content: space-between;
        }

            .op-hoadon-infor > .op-hoadon-name > div {
                max-width: calc(100% - 100px);
                display: flex;
                align-items: center;
            }

                .op-hoadon-infor > .op-hoadon-name > div > span {
                    overflow: hidden;
                    text-overflow: ellipsis;
                    white-space: nowrap;
                    max-width: 250px;
                }

        .op-hoadon-soluong-modify {
            min-width: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: none;
            height: 30px;
            border-radius: 0;
            transition: all 0.4s ease;
        }

            .op-hoadon-soluong-modify .material-icons {
                font-size: 18px;
            }

            .op-hoadon-soluong-modify:hover, .op-hoadon-soluong-modify:focus, .op-hoadon-soluong-modify:active {
                background: #ccc;
                border-radius: 15px;
                outline: none;
            }

        .op-hoadon-infor > .op-hoadon-name > div > span {
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            max-width: 250px;
        }

        .op-hoadon-item:hover .op-hoadon-ghichu {
            display: block;
        }

        .op-hoadon-infor > .op-hoadon-ghichu {
            position: absolute;
            height: 18px;
            background: unset;
            width: 150px;
            left: 133px;
            top: unset;
            width: 250px;
            padding: 1px 5px;
            z-index: 3;
            bottom: 0;
        }

        .op-hoadon-lohang {
            display: flex;
        }

            .op-hoadon-lohang > div {
                display: flex;
                align-items: center;
            }

                .op-hoadon-lohang > div .op-hoadon-lohang-input {
                    width: 75px;
                    line-height: 18px;
                    height: 24px;
                    padding: 3px;
                    align-items: center;
                    border: 1px solid #Ccc;
                    padding: 3px;
                    line-height: 18px;
                    border-radius: 3px;
                    text-align: left;
                }

            .op-hoadon-lohang label {
                height: 24px;
                line-height: 18px;
                padding: 3px;
                max-width: 75px;
                margin-bottom: 0;
            }

        .op-hoadon-item.op-hoadon-header .op-hoadon-quanlity > div {
            line-height: 24px;
        }

        .op-hoadon-quanlity > .op-hoadon-soluong {
            width: calc(30px + 30px + 60px);
            min-height: 24px;
            text-align: center;
            max-width: 120px;
        }

        .op-hoadon-quanlity > .op-hoadon-dongia {
            width: var(--input-range);
            line-height: 18px;
            min-height: 24px;
        }

        .op-hoadon-quanlity > .op-hoadon-chucnang {
            width: calc( 30px * 5 );
            line-height: 18px;
            min-height: 24px;
            position: relative;
        }

        .op-hoadon-quanlity > .op-hoadon-thanhtoan {
            width: var(--input-range);
            line-height: 18px;
            min-height: 24px;
        }

        .op-hoadon-quanlity > .op-hoadon-baohiem {
            width: var(--input-range);
            line-height: 18px;
            min-height: 24px;
        }

        .op-hoadon-quanlity > .op-hoadon-soluong {
            width: calc(30px + 30px + 60px);
            min-height: 24px;
            MAX-WIDTH: 120PX;
        }

            .op-hoadon-quanlity > .op-hoadon-soluong input {
                text-align: center;
                width: 60px;
            }

        .op-banhang-mobile-menu {
            display: flex;
            display: none;
            position: fixed;
            z-index: 99999;
            background: white;
            top: 25vh;
            right: 25vw;
            padding: 15px;
            width: 50vw;
            height: 50vh;
            border: 1px solid #ccc;
            box-shadow: 10px 10px 20px rgba(0,0,0,0.15);
        }

            .op-banhang-mobile-menu ul {
                width: 100%;
                position: relative;
                display: flex;
                align-items: center;
                justify-content: flex-start;
                flex-wrap: wrap;
                height: 100%;
            }

                .op-banhang-mobile-menu ul li {
                    display: flex;
                    width: 27%;
                    border: 1px dashed #ccc;
                    padding: 10px;
                    display: flex;
                    align-items: flex-start;
                    flex-direction: column;
                    margin: 3%;
                    justify-content: center;
                    align-items: center;
                    min-height: 100px;
                    border-radius: 3px;
                    cursor: pointer;
                }

                    .op-banhang-mobile-menu ul li:hover {
                        border-style: solid;
                    }

                    .op-banhang-mobile-menu ul li i {
                        font-size: 40px;
                    }

        @@media(max-width:1024px) {
            .op-hoadon-infor {
                width: 50%;
            }

            .op-hoadon-quanlity {
                width: 50%;
                justify-content: space-between;
            }
        }

        @@media(max-width:1366px) {
            .op-hoadon-thongtinkhac > div > div {
                padding-left: 0;
                text-align: left;
            }

            :root {
                --input-range: 75px;
            }
        }

        .expiry-date-service .form-group label {
            width: 110px !important;
            margin-top: 0;
            line-height: 30px !important;
            border-radius: 0px;
        }

        .expiry-date-service .form-group .form-news {
            width: 30%;
        }


        .expiry-date-service .form-news input {
            border: none;
            border-bottom: 1px solid #ccc;
            box-shadow: none;
        }

        .expiry-date-service .form-group {
            /*width: 55% !important;*/
            margin: 0px !important;
        }
    </style>
</head>
<body>

    <input id="CopiedText" style="position:fixed; z-index:-1;top:0; left:0" hidden />
    <div class="container-fluid" id="Gara" style="opacity: 0; visibility: hidden; transition: opacity 0.5s linear; ">
        <div id="tree2" hidden></div>
        <div class="gara-header-sections row">
            <input type="hidden" value="@ViewBag.cookieDonVi" id="txtDonVi" />
            <input type="hidden" value="@contant.GetUserCookies().ID_NhanVien" id="txtIDNhanVien" />
            <input type="hidden" value="@contant.GetUserCookies().ID" id="txtIDUser" />
            <input type="hidden" value="@contant.GetUserCookies().TaiKhoan" id="txtUserLogin" />
            <input type="hidden" value="@ViewBag.shopCookies" id="txtShopCookie" />
            <input type="hidden" value="@ViewBag.SubDomain" id="subDomain" />
            <div class="gara-col-left flex">
                <a data-bind="click: $root.GotoHome" class="gara-logo" id="btnGoHome">
                    <img src="~/Content/images/logo-open24-min.png" class='op-desktop-logo' alt="logo open24" title="Logo open24" />
                </a>
                <a class="op-gara-togglebill" hidden onclick="ShowPopupTab()"><i class="material-icons">menu</i></a>
                <div title="Thêm mới hàng hóa" class="garaTK" id="el">
                    <i class="material-icons icon-searchs">search</i>
                    <input type="text" class="form-control gara-search-HH " autocomplete="off"
                           id="txtSearchHH" placeholder="Tìm kiếm"
                           v-model="query"
                           v-on:keyup="search"
                           v-on:keyup.13="keyEnter"
                           v-on:keyup.up="keyUp"
                           v-on:keyup.down="keyDown" style="margin:-5px 0">
                    <a class="gara-button-icon" title="Thêm mới hàng hóa"
                       data-bind="click: ShowForm_NewProduct">
                        <i class="material-icons">add</i>
                    </a>
                    <div class="gara-search-dropbox drop-search" style="top:35px; min-width:350px">
                        <ul v-on:scroll.passive="scrollList">
                            <li v-for="(item, index) of searchList"
                                v-on:click="click(item)"
                                v-bind:style="   [$root.indexFocus === index ? {'background':'#d9d9d9'} : {'background':'none'}]">
                                <div>
                                    <span>{{item.MaHangHoa}}</span>
                                    <span v-if="item.TenDonViTinh">
                                        <i>
                                            {{'('+ item.TenDonViTinh + ')'}}
                                        </i>
                                    </span>
                                    <span class="floatRight">
                                        Tồn: {{formatNumber3Digit(item.TonKho,3)}}
                                    </span>
                                </div>
                                <div style="display:flex;justify-content:space-between">
                                    <span class="bold" style="max-width:calc(100% - 100px)">{{item.TenHangHoa}}</span>
                                    <span class="floatRight">
                                        Giá:  {{formatNumber3Digit(item.GiaBan)}}
                                    </span>
                                </div>
                                <div v-if="item.MaLoHang">
                                    <span>	&nbsp;  </span>
                                    <span class="floatright font-Red">
                                        Lô:  {{item.MaLoHang}}
                                    </span>
                                </div>
                                <div v-if="item.TenNhomHangHoa">
                                    <span class="floatright">
                                        {{item.TenNhomHangHoa}}
                                    </span>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="flex ">
                    <div class="gara-fast-input" style="min-width:175px" hidden>
                        <input type="text" class="form-control text-right" placeholder="Số lượng"
                               data-bind="value: $root.txtSoLuong">
                        <input type="text" class="form-control text-right" placeholder="Đơn giá"
                               data-bind="value: $root.txtDonGia">
                    </div>
                    <a style="padding:3px 12px; display:none" onclick="togglefastInput(this)">
                        <img src="/Content/images/print-min.png" alt="nhập nhanh" />
                    </a>
                </div>
                <div class="gara-bill-navigation">
                    <a data-bind="click: prevHoaDon, visible: hasPrevHD">
                        <i class="material-icons">navigate_before</i>
                    </a>
                    <div class="gara-bill-label">

                        <ul style="margin-top:-3px" data-bind="foreach: result_HoaDon">
                            <li data-bind="click: $root.GetThongTinHoaDon,
  attr:{class: IsActive, title: MaHoaDon}">
                                <img class="act-r" src="/Content/images/coner.png" hidden="" alt="">
                                <span data-bind="text: MaHoaDon"></span>
                                <font data-bind="attr:{id:'li_'+ $index() }, text: MaHoaDon" hidden></font>
                                <a class="gara-button-icon" data-bind="click: $root.CloseHoaDon">
                                    <i class="material-icons">close</i>
                                </a>
                                <img class="act-l" src="/Content/images/coner.png" hidden="" tabindex="-1" alt="">
                            </li>
                        </ul>
                    </div>
                    <a data-bind="click:addPhongBan">
                        <i class="material-icons">add</i>
                    </a>
                    <a data-bind="click: nextHoaDon, visible: hasNextHD">
                        <i class="material-icons">navigate_next</i>
                    </a>
                </div>
            </div>
            <div class="gara-col-right">
                <div class="gara-chinhanh">
                    <a class="gara-chinhanh-picker" data-bind="click: showChiNhanh_byUser">
                        <i class="material-icons font-18px" style="padding:6px;">location_on</i>
                        <span class="black-686868 text-ellipsis " style="padding:6px 3px; max-width:100px; " data-bind="text:titleChinhanh"></span>
                        <i class="material-icons">expand_more</i>
                        <i class="material-icons" hidden style="display:none">expand_less</i>
                    </a>
                    <div class="gara-list-drop" hidden>
                        <div class="position-relative">
                            <input style="padding-left:30px;" class="form-control" placeholder="Tìm kiếm"
                                   data-bind="value: filterChiNhanh,  valueUpdate: 'afterkeydown'" />
                            <i class="material-icons black-686868" style="position:absolute;      top: 4px;    left: 4px;   ">search</i>
                        </div>
                        <ul data-bind="foreach: arrChiNhanhs_byUser">
                            <li data-bind="click: $root.ChangeChiNhanh">
                                <a href="javascript:void(0)" data-bind="text: TenDonVi"></a>
                                <span data-bind="visible: $root.selectedChiNhanh() == ID">
                                    <i class="fa fa-check pull-right my-fa-check" style="display:block"></i>
                                </span>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="gara-functions" style="width:240px">
                    <!--ko if: RoleInsert_Return()-->
                    <a data-bind="click: $root.showpopuptrahangHD">
                        <i class="material-icons">reply_all</i>
                    </a>
                    <!--/ko-->
                    <a data-bind="click: showHoaDonOffline" title="Đồng bộ dữ liệu">
                        <span class="synchronousspan" data-bind="text: countHDoffilne, visible: countHDoffilne() > 0"
                              style="color:var(--color-primary); right:unset!important;top:-9px!important">0</span>
                        <i class="material-icons">cloud_upload</i>
                    </a>
                    <a onclick="showpopup(2)" data-bind="click: function(){ BindSettingPrint(false)} ">
                        <i class="material-icons">print</i>
                    </a>
                    <a onclick="showpopup(4)">
                        <i class="material-icons">settings</i>
                    </a>
                    <a data-bind="click: CheckRole_ChangeNVien">
                        <i class="material-icons">person</i>
                    </a>
                    <div class="popup-detail" hidden>
                        <div class="gara-help gara-help-button" hidden>
                            <h5 class="bold">Phím tắt</h5>
                            <div>
                                <label>F1</label>
                                <p>Sơ đồ phòng sử dụng </p>
                            </div>
                            <div>
                                <label>F2</label>
                                <p>Danh sách hàng hóa đang bán</p>
                            </div>
                            <div>
                                <label>F3</label>
                                <p>Tìm hàng hóa</p>
                            </div>
                            <div>
                                <label>F4</label>
                                <p>Tìm khách hàng</p>
                            </div>
                            <div>
                                <label>F6</label>
                                <p>Thay đổi chế độ nhập số lượng</p>
                            </div>
                            <div>
                                <label>F10</label>
                                <p>Thanh toán</p>
                            </div>
                            <div>
                                <label>Home</label>
                                <p>Thay đổi số lượng sản phẩm đầu</p>
                            </div>
                            <div>
                                <label>End</label>
                                <p>Thay đổi số lượng sản phẩm cuối</p>
                            </div>
                            <div>
                                <label>
                                    <i class="material-icons">keyboard_arrow_up</i>
                                </label>
                                <p>Giảm số lượng</p>
                            </div>
                            <div>
                                <label>
                                    <i class="material-icons">keyboard_arrow_down</i>
                                </label>
                                <p>Tăng số lượng</p>
                            </div>
                            <div>
                                <label>
                                    <i class="material-icons"> keyboard_return</i>
                                </label>
                                <p>Di chuyển đến ô giá trị tiếp theo </p>
                            </div>
                            <div>
                                <label>
                                    <i class="material-icons"> keyboard_return</i>
                                </label>
                                <p>Di chuyển đến ô giá trị phía trước </p>
                            </div>
                        </div>
                        <div class="gara-help gara-help-printer" hidden>
                            <h4 class="bold">Thiết đặt mẫu in/hiển thị</h4>
                            <div hidden>
                                <label for="hienthiphongban">
                                    Hiển thị sơ đồ phòng bàn
                                </label>
                                <input type="checkbox"
                                       data-bind="checked: setViewSoDoPhong, event:{change: function() {ChangeSetPrint(6) } }" />
                            </div>
                            <div>
                                <label for="anhanghoahettonkho">
                                    Ẩn hàng hóa đã hết tồn kho khi tìm kiếm
                                </label>
                                <input type="checkbox"
                                       data-bind="checked: setHideProduct, event:{change: function() {ChangeSetPrint(4) } }" />
                            </div>
                            <div>
                                <label for="innhap">
                                    In nháp hóa đơn
                                </label>
                                <input type="checkbox"
                                       data-bind="checked: setPrintDraft, event:{change: function() {ChangeSetPrint(1) } }" />
                            </div>
                            <div>
                                <label for="inhoadonkhichonthanhtoan">
                                    In hóa đơn khi thanh toán
                                </label>
                                <input type="checkbox"
                                       data-bind="checked: setPrintPay, event:{change: function() {ChangeSetPrint(3) } }" />
                            </div>
                            <div>
                                <label for="solienkhiin">
                                    Số liên khi in
                                </label>
                                <div class="flex flex-around">
                                    <a data-bind="click: function(){increaseNumberPrint(false)}">
                                        <i class="material-icons">chevron_left</i>
                                    </a>
                                    <input type="number" onclick="this.select()"
                                           onkeypress="return keypressNumber(event)"
                                           data-bind="value: numberOfPrint, event:{keyup: editNumberOfPrint}"
                                           style="   line-height: 18px;   width: 75px;   height: 23px;   text-align: center;   margin: 4px 0;    }" min="1" value="1" />
                                    <a data-bind="click: function(){increaseNumberPrint(true)}">
                                        <i class="material-icons">chevron_right</i>
                                    </a>
                                </div>
                            </div>
                            <div>
                                <label for="chonmauin">
                                    Chọn mẫu in
                                </label>
                                <select id="ddlTempPrint" style="width:200px"
                                        data-bind="foreach: ListTempPrint, event: {change: Change_MauIn} ">
                                    <option data-bind="value:ID,text:TenMauIn"></option>
                                </select>
                            </div>
                        </div>
                        <div class="gara-help gara-help-user" hidden>
                            <div class="flex text-center" style="align-items:center">
                                <i class="material-icons">person</i>
                                <span data-bind="text:titleNhanvien"></span>
                            </div>
                            <input class="form-control" placeholder="Tìm kiếm nhân viên"
                                   data-bind="value: filterNVien, valueUpdate: 'afterkeydown'" />
                            <ul class="gara-help-user-list" data-bind="foreach: arrFilterNhanVien">
                                <li data-bind="click: $parent.ChangeNVienBan">
                                    <div>
                                        <span data-bind="text: TenNhanVien">
                                        </span>
                                        <span class="floatRight" data-bind="visible: $root.selectedNVien() == ID">
                                            <i class="fa fa-check"></i>
                                        </span>
                                    </div>
                                </li>
                            </ul>
                            <a class="flex-center" href="/Login">
                                <i class="material-icons">power_settings_new</i>Đăng xuất
                            </a>
                        </div>
                        <div class="gara-help gara-help-settings" hidden>
                            <a data-bind="click: showpopupDatHang">
                                <i class="material-icons">business_center</i> Xử lý đặt hàng
                            </a>
                            <!--ko if: RoleInsert_Return()-->
                            <a data-bind="click: showpopuptrahangHD">
                                <i class="material-icons">reply</i> Chọn hóa đơn trả hàng
                            </a>
                            <!--/ko-->
                            <a data-bind="click: ShowmyModalinport">
                                <i class="material-icons">request_quote</i> Import hóa đơn đặt hàng
                            </a>
                            <!--ko if: $root.roleCustomer_ThanhToanNo()-->
                            <a data-bind="click: showPopupLapPhieuThu">
                                <i class="material-icons">note_add</i> Lập phiếu thu
                            </a>
                            <!--/ko-->
                            <a href="/#/Invoices">
                                <i class="material-icons">work</i> Quản lý
                            </a>
                            <a data-bind="click: FullScreen">
                                <i class="material-icons">fullscreen</i> Toàn màn hình
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="gara-bill-sections row">
            <div class="gara-col-left bill-main">
                <div class="op-hoadon-item op-hoadon-header">
                    <div class="op-hoadon-infor">
                        <div class="op-hoadon-stt">
                            STT
                        </div>
                        <div class="op-hoadon-id">
                            <span>Mã Hàng hóa</span>
                        </div>
                        <div class="op-hoadon-name">
                            Tên hàng hóa
                        </div>
                    </div>
                    <div class="op-hoadon-quanlity">
                        <div class="op-hoadon-soluong">
                            Số lượng
                        </div>
                        <div class="op-hoadon-dongia">
                            Đơn giá
                        </div>
                        <!-- ko if: HoaDons().ID_BaoHiem() !==null && HoaDons().LoaiHoaDon() === 25 -->
                        <div class="op-hoadon-baohiem">
                            <div class="position-relative">
                                <div onclick="showpopupbaohiem()"> Bảo hiểm</div>
                                <div class="gara-popup-baohiem" id="popupbaohiem">
                                    <div class="flex" style="align-items:flex-end">
                                        <div style="font-weight:normal">Giá bảo hiểm duyệt &nbsp;= </div>
                                        <input class="input-simple width-75 height-30 text-center"
                                               onclick="this.select()"
                                               style="border-bottom:1px solid #ccc;text-align:center" placeholder="0"
                                               onkeypress="keypressNumber_limitNumber(event, this)"
                                               data-bind="value: HoaDons().HeaderBH_GiaTriPtram, 
                                               event:{keyup: $root.EditHeaderBH}," />
                                               
                                        <button class="btn btn-main height-30">%</button>
                                        <div class="dropdown">
                                            <div class="form-control" data-toggle="dropdown"
                                                 data-bind="text:  HoaDons().HeaderBH_Type()=== 1?'Giá bán':' Đơn giá'">
                                            </div>
                                            <ul class="dropdown-menu" style="min-width:unset">
                                                <li data-bind="click: function(){$root.HeaderBH_ChangeType(1)}">
                                                    <a href="javascript:void(0)" class="flex flex-between">
                                                        <span>
                                                            Giá bán
                                                        </span>
                                                        <i class="fa fa-check" data-bind="visible: HoaDons().HeaderBH_Type() === 1"></i>
                                                    </a>
                                                </li>
                                                <li data-bind="click: function(){ $root.HeaderBH_ChangeType(2)}">
                                                    <a href="javascript:void(0)" class="flex flex-between">
                                                        <span>
                                                            Đơn giá
                                                        </span>
                                                        <i class="fa fa-check" data-bind="visible: HoaDons().HeaderBH_Type() === 2"></i>
                                                    </a>
                                                </li>
                                            </ul>
                                        </div>

                                    </div>
                                    <div class="flex flex-end padding-5">
                                        <button class="btn btn-main height-24 lineHeight-18"
                                                data-bind="click: $root.HeaderBH_Apply">
                                            Áp dụng
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!--/ko-->
                        <div class="op-hoadon-thanhtoan">
                            Thanh toán
                        </div>
                        <div class="op-hoadon-chucnang">
                            &nbsp;
                        </div>
                    </div>
                </div>
                <div class="mobile-empty-alert " data-bind="visible: HangHoaAfterAdds().length<=0">
                    <a class="flex flex-center" style="align-items: center; color: gray; display: flex; flex-direction: column; padding: 15px;">
                        <i class="material-icons">help</i>
                        Hóa đơn không có hàng hóa
                    </a>
                </div>
                <div class="op-hoadon-list" data-bind="foreach: HangHoaAfterAdds, css : { 'fillscreen' : (HoaDons().LoaiHoaDon()!==6) } ">
                    <div>
                        <!--Hàng hóa thông thường-->
                        <div class="op-hoadon-item ctLo" data-bind="attr:{id: IDRandom}">
                            <div class="op-hoadon-infor" data-bind="css:{'op-hanghoa-lohang': QuanLyTheoLoHang}">
                                <div class="op-hoadon-stt">
                                    <span data-bind="text:SoThuTu,
                                          style:{'background': ID_LichBaoDuong!== null? '#e35b19': !LaHangHoa ?'var(--color-main)':'none',
                                          'color': !LaHangHoa || ID_LichBaoDuong!=null?'white':'none'}"></span>
                                </div>
                                <div class="op-hoadon-id">
                                    <span data-bind="text:MaHangHoa, attr:{title: MaHangHoa}"></span>
                                </div>
                                <div class="op-hoadon-name">
                                    <div class="flex" style="width:100%">
                                        <input type="text" class="form-control bold  border-none" onclick="this.select()"
                                               data-bind="value:TenHangHoaThayThe,
                                               attr:{id: 'ten_'+ IDRandom, title: TenHangHoaThayThe},
                                               event:{keyup: function() {$root.editTenThayThe($data, false)},
                                               mouseout: $root.mouseoutTenThayThe}" />
                                        <span class="green" data-bind="text: ThuocTinh_GiaTri"></span>
                                    </div>
                                    <div class="dropdown" data-bind="visible: ListDonViTinh.length > 0">
                                        <a class="btn btn-link height-24" data-toggle="dropdown" data-bind="text: TenDonViTinh">
                                        </a>

                                        <ul class="dropdown-menu" data-bind="foreach: ListDonViTinh">
                                            <li>
                                                <a data-bind=" click: function(){$root.ChangeDonViTinh($data, $parent, false)}">
                                                    <span data-bind="text: TenDonViTinh"></span>
                                                </a>
                                            </li>
                                        </ul>

                                    </div>
                                </div>
                                <div class="op-hoadon-ghichu">
                                    <input class="input-simple" required placeholder="Ghi chú sản phẩm" data-bind="value: GhiChu, event:{keyup: function(){$root.UpdateCTHD_GhiChu ($data,false)}}" />
                                    <i class="fa fa-pencil"></i>
                                </div>
                            </div>
                            <div class="op-hoadon-infor" data-bind="visible: QuanLyTheoLoHang">
                                <div class="op-hoadon-lohang">
                                    <div>
                                        <label>Lô hàng</label>
                                        <div class="dropdown">
                                            <input class="op-hoadon-lohang-input" data-toggle="dropdown" data-bind="value: DM_LoHang.length > 0? DM_LoHang[0].MaLoHang:'',    click: $root.LoadListLot_ofProduct,   event:{keyup: $root.SearchLot_ofProduct}" />
                                            <ul class="dropdown-menu" style="width:275px; left:0" data-bind="foreach: $root.ListLot_ofProduct,visible: $root.ListLot_ofProduct().length > 0">
                                                <li>
                                                    <a data-bind="click: $root.ClickChoseLot">
                                                        <div class="flex flex-between">
                                                            <span class="bold" data-bind="text: MaLoHang">Tên lô hàng</span>
                                                            <span>
                                                                Tồn :
                                                                <span data-bind="text: formatNumber3Digit(TonKho)"></span>
                                                            </span>
                                                        </div>
                                                        <div class="flex flex-between">
                                                            <span data-bind="visible: NgaySanXuat">
                                                                NSX:
                                                                <span class="green" data-bind="text: moment(NgaySanXuat).format('DD/MM/YYYY')!='Invalid date'? moment(NgaySanXuat).format('DD/MM/YYYY'):''"></span>
                                                            </span>
                                                            <span data-bind="visible: NgayHetHan">
                                                                HSD:
                                                                <span class="red" data-bind="text: moment(NgayHetHan).format('DD/MM/YYYY')!='Invalid date'? moment(NgayHetHan).format('DD/MM/YYYY'):''"></span>
                                                            </span>
                                                        </div>
                                                    </a>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                    <div>
                                        <label>NSX</label>
                                        <input class="op-hoadon-lohang-input" placeholder="Ngày SX" data-bind="visible: DM_LoHang.length > 0 && (DM_LoHang[0].NgaySanXuat =='' || DM_LoHang[0].NgaySanXuat == null)" />
                                        <div class="op-hoadon-lohang-input bg-green" data-bind="visible: DM_LoHang.length > 0 && DM_LoHang[0].NgaySanXuat !='' && DM_LoHang[0].NgaySanXuat !== null">
                                            <span data-bind="text: DM_LoHang.length > 0 ? DM_LoHang[0].NgaySanXuat:'N/A'">20/10/2020</span>
                                        </div>
                                    </div>
                                    <div>
                                        <label>HSD</label>
                                        <input class="op-hoadon-lohang-input" placeholder="Hạn SD" data-bind="visible: DM_LoHang.length > 0 && (DM_LoHang[0].NgayHetHan =='' || DM_LoHang[0].NgayHetHan == null)" />
                                        <div class="op-hoadon-lohang-input bg-red" data-bind=" visible: DM_LoHang.length > 0 && DM_LoHang[0].NgayHetHan !='' && DM_LoHang[0].NgayHetHan !== null">
                                            <span data-bind="text: DM_LoHang.length > 0? DM_LoHang[0].NgayHetHan:''">20/10/2020</span>
                                        </div>
                                    </div>
                                </div>
                                @*<div class="op-hoadon-ghichu">
                                        <input class="input-simple" required placeholder="Ghi chú sản phẩm" data-bind="value: GhiChu, event:{keyup: function(){$root.UpdateCTHD_GhiChu ($data,false)}}" />
                                        <i class="fa fa-pencil"></i>
                                    </div>*@
                            </div>
                            <div class="op-hoadon-quanlity">
                                <div class="op-hoadon-soluong">
                                    <div class="flex">
                                        <button data-bind="click: $root.giamSoLuong" class='op-hoadon-soluong-modify'><i class="fa fa-angle-down" title="Thêm hàng hóa"></i></button>
                                        <input class="input-simple height-24" onkeypress="keypressNumber_limitNumber(event, this)" onclick="this.select()"
                                               data-bind="value: formatNumber3Digit(SoLuong), attr:{id:'munber_' + IDRandom}, event:{keyup: $root.editSoluong }, enable: $root.HoaDons().StatusOffline() == false" />
                                        <span class="gara-return-number" data-bind="text: '/' + formatNumber3Digit(SoLuongDaMua), visible: SoLuongDaMua > 0">/1000</span>
                                        <button data-bind="event:{click: $root.tangSoLuong }" class='op-hoadon-soluong-modify'><i class="fa fa-angle-up" title="Thêm hàng hóa"></i></button>
                                    </div>

                                </div>
                                <div class="op-hoadon-dongia">
                                    <div class="flex">
                                        <!--ko if: $root.roleChangePriceProduct()  -->
                                        <input class="input-simple height-24"
                                               autocomplete="off"
                                               onkeypress="return keypressNumber(event)" onclick="this.select()" maxlength="12"
                                               data-bind="value: formatNumber3Digit(GiaBan) , attr:{id: IDRandom},event:{keyup: $root.editPrice}" />
                                        <!-- /ko-->
                                        <!-- ko if: !$root.roleChangePriceProduct()-->
                                        <label class="input-simple height-24" data-bind="text: formatNumber3Digit(GiaBan),    attr:{id:IDRandom}"></label>
                                        <!-- /ko-->
                                    </div>
                                </div>
                                <!-- ko if: $root.HoaDons().ID_BaoHiem() !==null && $root.HoaDons().LoaiHoaDon() === 25 -->
                                <div class="op-hoadon-baohiem">
                                    <div class="flex ">
                                        <input class="input-simple height-24"
                                               onkeypress="return keypressNumber(event)"
                                               onclick="this.select()"
                                               data-bind="value: formatNumber3Digit(DonGiaBaoHiem),
                                               event:{keyup: $root.editDonGiaBaoHiem},
                                               attr:{id:'giabh_' + IDRandom}" />
                                    </div>
                                </div>
                                <!--/ko-->
                                <div class="op-hoadon-thanhtoan">
                                    <div class="flex">
                                        <!--ko if: $root.roleChangePriceProduct() -->
                                        <input class="input-simple height-24 bold"
                                               onkeypress="return keypressNumber(event)" onclick="this.select()" maxlength="12"
                                               data-bind="value: formatNumber3Digit(ThanhToan), attr:{id: 'sum-f_' + IDRandom},
                                               event:{keyup: $root.editSumPrice}" />
                                        <!-- /ko-->
                                        <!--ko if: !$root.roleChangePriceProduct()-->
                                        <label class="input-simple height-24 bold" data-bind="text: formatNumber3Digit(ThanhToan),
                                               attr:{id: 'sum-f_'+ IDRandom}"></label>
                                        <!--/ko-->
                                    </div>
                                </div>

                                <div class="op-hoadon-chucnang">
                                    <div class="flex flex-end">
                                        <button class='op-hoadon-soluong-modify'
                                                data-bind="click: function(){ $root.ShowPop_ChangeTPDinhLuong ($data,false )},
                                                visible: LoaiHangHoa ==3 || (LoaiHangHoa == 2 && LoaiHoaDon !== 6),
                                                attr:{title: LoaiHangHoa=== 3?'Thành phần combo':'Thành phần định lượng'}">
                                            <i class="fa fa-list font-14"></i>
                                        </button>
                                        <button class='op-hoadon-soluong-modify' title="Chiết khấu hàng hóa" data-bind="click: $root.showDivSale_CTHD" onclick="showPopupChietKhau()">
                                            <i class=" fa fa-percent font-14"></i>
                                        </button>
                                        <button class='op-hoadon-soluong-modify' title="Thêm hàng hóa"
                                                data-bind="click: $root.addLot, visible: LoaiHangHoa !==3">
                                            <i class="material-icons">add</i>
                                        </button>
                                        <button class='op-hoadon-soluong-modify' title="Chiết khấu nhân viên"
                                                data-bind="click:function(){$root.showPopupUserDiscount($data, false)} ,visible: LoaiHoaDon ==1 ||  LoaiHoaDon ==19 || LoaiHoaDon == 25">
                                            <i class="material-icons">person</i>
                                        </button>
                                        <button class='op-hoadon-soluong-modify' data-bind="click: $root.xoaHangHoa">
                                            <i class="material-icons">close</i>
                                        </button>
                                        <div class="gara-popup-chietkhau">
                                            <div style="display:flex; margin-bottom:5px; justify-content:space-around">
                                                <span>Chiết khấu</span>
                                                <input class="gara-input " style="width:100px; margin:0 10px; height:24px;"
                                                       autocomplete="off"
                                                       onclick="this.select()"
                                                       onkeypress="keypressNumber_limitNumber(event, this)"
                                                       data-bind="attr:{id:'pri-g_' + IDRandom}, event:{keyup: $root.editSale}" />
                                                <div class="toogle toogle-report Ptram"
                                                     data-bind="attr:{id: 'vnd_'+ IDRandom}">
                                                    <span class="poison" data-bind="click: $root.clickVND">VNĐ</span>
                                                    <span class="transverse"
                                                          data-bind="click: $root.clickVND">%</span>
                                                </div>
                                            </div>
                                            <div style="display:flex; margin-bottom:5px; justify-content:space-around">
                                                <span>Thuế</span>
                                                <input class="gara-input " style="width:100px; margin:0 10px; height:24px;"
                                                       onkeypress="keypressNumber_limitNumber(event, this)"
                                                       autocomplete="off"
                                                       onclick="this.select()"
                                                       data-bind="attr:{id:'ipTaxCT_' + IDRandom}, event:{keyup: $root.cthd_editThue}" />
                                                <div class="toogle toogle-report Ptram"
                                                     data-bind="css:{'active-re': PTThue > 0 || (PTThue ==0 && TienThue ==0)},attr:{id: 'taxCT_'+ IDRandom}">
                                                    <span class="poison" data-bind="click: $root.cthd_clickThue">VNĐ</span>
                                                    <span class="transverse" data-bind="click: $root.cthd_clickThue">%</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="op-hoadon-thongtinkhac">
                                <div class="flex flex-column op-hoadon-infor">
                                    <div class="op-hoadon-chietkhaunhanvien" data-bind="visible:GhiChu_NVThucHien.length>0">
                                        <small data-bind="text: GhiChu_NVThucHien"></small>
                                    </div>
                                    <div class="op-hoadon-chietkhaunhanvien" data-bind="visible:GhiChu_NVTuVan.length>0">
                                        <small data-bind="text: GhiChu_NVTuVan"></small>
                                    </div>
                                </div>
                                <div class="flex flex-column op-hoadon-quanlity">
                                    <div class="op-hoadon-thue" data-bind="visible: TienChietKhau> 0">
                                        <small>Chiết khấu:</small>
                                        <small data-bind="text: formatNumber3Digit(TienChietKhau), attr:{id:'ck_'+ IDRandom}"></small>
                                    </div>
                                    <div class="op-hoadon-thue" data-bind="visible: TienThue> 0">
                                        <small>Thuế:</small>
                                        <small data-bind="text: formatNumber3Digit(TienThue),attr:{id:'tax_'+ IDRandom}"></small>
                                    </div>
                                </div>
                            </div>

                            <div class="op-hoadon-hangkhuyenmai" hidden style="display:none">
                                <div class="op-hoadon-hangkhuyenmai-thongtin" style="width:100%">
                                    <button><i class="fa fa-gift red"></i></button> <span>Hàng hóa abc được khuyến mãi cde</span>
                                </div>
                                <div class="op-hoadon-infor">
                                    <div class="op-hoadon-stt">
                                    </div>
                                    <div class="op-hoadon-id">
                                    </div>
                                    <div class="op-hoadon-name">
                                        <div class="flex">
                                            <span class="bold">Tên hàng hóa 1</span>
                                            <span class="green">_Giá trị thuộc tính</span>
                                        </div>
                                    </div>
                                    <div class="op-hoadon-quanlity" style="display:none">
                                        <div class="op-hoadon-soluong">
                                            <div class="flex">
                                                <button class='op-hoadon-soluong-modify'><i class="fa fa-angle-down" title="Thêm hàng hóa"></i></button>
                                                <input class="input-simple height-24" placeholder="1,000,000,000" />
                                                <button class='op-hoadon-soluong-modify'><i class="fa fa-angle-up" title="Thêm hàng hóa"></i></button>
                                            </div>
                                        </div>
                                        <div class="op-hoadon-dongia">
                                            <div class="flex">
                                                <input class="input-simple height-24" placeholder="1,000,000,000" />
                                            </div>
                                        </div>
                                        <div class="op-hoadon-thanhtoan">
                                            <div class="flex">
                                                <input class="input-simple height-24" placeholder="1,000,000,000" />
                                            </div>
                                        </div>
                                        <!-- ko if: $root.HoaDons().ID_BaoHiem() !==null && $root.HoaDons().LoaiHoaDon() === 25 -->
                                        <div class="op-hoadon-baohiem">
                                            <div class="flex ">
                                                <div class="flex ">
                                                    <input class="input-simple height-24"
                                                           onclick="this.select()"
                                                           onkeypress="return keypressNumber(event)"
                                                           data-bind="value: formatNumber3Digit(DonGiaBaoHiem),
                                               event:{keyup: $root.editDonGiaBaoHiem},
                                                           attr:{id:'giabh_' + IDRandom}" />
                                                </div>
                                            </div>
                                        </div>
                                        <!--/ko-->
                                        <div class="op-hoadon-chucnang">
                                            <div class="flex flex-end">
                                                <button class='op-hoadon-soluong-modify'><i class="fa fa-angle-down" title="Thêm hàng hóa"></i></button>
                                                <button class='op-hoadon-soluong-modify'><i class="fa fa-angle-down" title="Thêm hàng hóa"></i></button>
                                                <button class='op-hoadon-soluong-modify'><i class="fa fa-angle-down" title="Thêm hàng hóa"></i></button>
                                                <button class='op-hoadon-soluong-modify'><i class="fa fa-angle-down" title="Thêm hàng hóa"></i></button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="op-hoadon-quanlity">
                                    <div class="op-hoadon-soluong">
                                        <div class="flex">
                                            <button class='op-hoadon-soluong-modify'><i class="fa fa-angle-down" title="Thêm hàng hóa"></i></button>
                                            <input class="input-simple height-24" placeholder="1,000,000,000" />
                                            <button class='op-hoadon-soluong-modify'><i class="fa fa-angle-up" title="Thêm hàng hóa"></i></button>
                                        </div>
                                    </div>
                                    <div class="op-hoadon-dongia">
                                        <div class="flex">
                                            <input class="input-simple height-24" placeholder="1,000,000,000" />
                                        </div>
                                    </div>
                                    <div class="op-hoadon-thanhtoan">
                                        <div class="flex">
                                            <input class="input-simple height-24" placeholder="1,000,000,000" />
                                        </div>
                                    </div>
                                    <!-- ko if: $root.HoaDons().ID_BaoHiem() !==null && $root.HoaDons().LoaiHoaDon() === 25 -->
                                    <div class="op-hoadon-baohiem">
                                        <div class="flex ">
                                            <input class="input-simple height-24"
                                                   onclick="this.select()"
                                                   onkeypress="return keypressNumber(event)"
                                                   data-bind="value: formatNumber3Digit(DonGiaBaoHiem),
                                               event:{keyup: $root.editDonGiaBaoHiem},
                                                   attr:{id:'giabh_' + IDRandom}" />
                                        </div>
                                    </div>
                                    <!--/ko-->
                                    <div class="op-hoadon-chucnang">
                                        <div class="flex flex-end">
                                            <button class='op-hoadon-soluong-modify'><i class="fa fa-angle-down" title="Thêm hàng hóa"></i></button>
                                            <button class='op-hoadon-soluong-modify'><i class="fa fa-angle-down" title="Thêm hàng hóa"></i></button>
                                            <button class='op-hoadon-soluong-modify'><i class="fa fa-angle-down" title="Thêm hàng hóa"></i></button>
                                            <button class='op-hoadon-soluong-modify'><i class="fa fa-angle-down" title="Thêm hàng hóa"></i></button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!--hàng cùng loại thường-->
                        <!--ko foreach: HangCungLoais-->
                        <div class="op-hoadon-item ctLo" data-bind="attr:{id: IDRandom}">
                            <div class="op-hoadon-infor">
                                <div class="op-hoadon-stt">
                                </div>
                                <div class="op-hoadon-id">
                                    <span data-bind="text:MaHangHoa,attr:{title: MaHangHoa}"></span>
                                </div>
                                <div class="op-hoadon-name">
                                    <div class="flex" style="width:100%">
                                        <input type="text" class="form-control bold  border-none" onclick=" this.select()"
                                               data-bind="value:TenHangHoaThayThe,
                                                attr:{id: 'ten_'+ IDRandom,title: TenHangHoaThayThe},
                                               event:{keyup: function() {$root.editTenThayThe($data, false)},
                                               mouseout: $root.mouseoutTenThayThe}" />
                                        <span class="green" data-bind="text: ThuocTinh_GiaTri"></span>
                                    </div>
                                    <div class="dropdown" data-bind="visible: ListDonViTinh.length > 0">
                                        <a data-toggle="dropdown" class="btn btn-link height-24" data-bind="text: TenDonViTinh">
                                        </a>
                                        <ul class="dropdown-menu" data-bind="foreach: ListDonViTinh">
                                            <li>
                                                <a data-bind="click: function(){$root.ChangeDonViTinh($data, $parent, false)}">
                                                    <span data-bind="text: TenDonViTinh"></span>
                                                </a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="op-hoadon-ghichu">
                                    <input class="input-simple" required placeholder="Ghi chú sản phẩm" data-bind="value: GhiChu, event:{keyup: function(){$root.UpdateCTHD_GhiChu ($data,false)}}" />
                                    <i class="fa fa-pencil"></i>
                                </div>
                            </div>
                            <div class="op-hoadon-quanlity">
                                <div class="op-hoadon-soluong">
                                    <div class="flex">
                                        <button class='op-hoadon-soluong-modify' data-bind="click: $root.giamSoLuong" title="giảm số lượng">
                                            <i class="fa fa-angle-down"></i>
                                        </button>
                                        <input class="input-simple height-24" onkeypress="keypressNumber_limitNumber(event, this)" onclick="this.select()"
                                               data-bind="value: formatNumber3Digit(SoLuong), attr:{id:'munber_' + IDRandom},
                                                event:{keyup: $root.editSoluong }, enable: $root.HoaDons().StatusOffline() == false" />
                                        <span class="gara-return-number" data-bind="text: '/' + formatNumber3Digit(SoLuongDaMua), visible: SoLuongDaMua > 0">/1000</span>
                                        <button class='op-hoadon-soluong-modify' data-bind="event:{click: $root.tangSoLuong }" title="Tăng số lượng"><i class="fa fa-angle-up"></i></button>
                                    </div>

                                </div>
                                <div class="op-hoadon-dongia">
                                    <div class="flex">
                                        <!--ko if: $root.roleChangePriceProduct()  -->
                                        <input class="input-simple height-24"
                                               autocomplete="off"
                                               onkeypress="return keypressNumber(event)" onclick="this.select()" maxlength="12"
                                               data-bind="value: formatNumber3Digit(GiaBan) , attr:{id: IDRandom},event:{keyup: $root.editPrice}, " />
                                        <!-- /ko-->
                                        <!-- ko if: !$root.roleChangePriceProduct()-->
                                        <label class="input-simple height-24" data-bind="text: formatNumber3Digit(GiaBan),    attr:{id:IDRandom}"></label>
                                        <!-- /ko-->
                                    </div>
                                </div>
                                <!-- ko if: $root.HoaDons().ID_BaoHiem() !==null && $root.HoaDons().LoaiHoaDon() === 25 -->
                                <div class="op-hoadon-baohiem">
                                    <div class="flex ">
                                        <input class="input-simple height-24"
                                               onclick="this.select()"
                                               onkeypress="return keypressNumber(event)"
                                               data-bind="value: formatNumber3Digit(DonGiaBaoHiem),
                                               event:{keyup: $root.editDonGiaBaoHiem},
                                               attr:{id:'giabh_' + IDRandom}" />
                                    </div>
                                </div>
                                <!--/ko-->
                                <div class="op-hoadon-thanhtoan">
                                    <div class="flex">
                                        <!--ko if: $root.roleChangePriceProduct() -->
                                        <input class="input-simple height-24"
                                               onkeypress="return keypressNumber(event)" onclick="this.select()" maxlength="12"
                                               data-bind="value: formatNumber3Digit(ThanhToan), attr:{id: 'sum-f_' + IDRandom}, event:{keyup: $root.editSumPrice}, " />
                                        <!-- /ko-->
                                        <!--ko if: !$root.roleChangePriceProduct()-->
                                        <label class="input-simple height-24" data-bind="text: formatNumber3Digit(ThanhToan), attr:{id: 'sum-f_'+ IDRandom}"></label>
                                        <!--/ko-->
                                    </div>
                                </div>

                                <div class="op-hoadon-chucnang">
                                    <div class="flex flex-end position-relative">
                                        <button class='op-hoadon-soluong-modify' title="Định lượng"
                                                data-bind="click: function(){ $root.ShowPop_ChangeTPDinhLuong ($data,false )},
                                                 visible: LoaiHangHoa ==3 || (LoaiHangHoa == 2 && LoaiHoaDon !== 6)">
                                            <i class=" fa fa-list font-14"></i>
                                        </button>
                                        <button class='op-hoadon-soluong-modify' data-bind="click: $root.showDivSale_CTHD" title="Chiết khấu hàng hóa" onclick="showPopupChietKhau()">
                                            <i class="fa fa-percent font-14"></i>
                                        </button>
                                        <button class='op-hoadon-soluong-modify' data-bind="click: $root.addLot" title="Thêm hàng hóa cùng loại">
                                            <i class="material-icons">add</i>
                                        </button>
                                        <button class='op-hoadon-soluong-modify' title="chiết khấu nhân viên" data-bind="click:function(){$root.showPopupUserDiscount($data, false)} ,visible: LoaiHoaDon ==1 ||  LoaiHoaDon ==19 || LoaiHoaDon == 25">
                                            <i class="material-icons">person</i>
                                        </button>
                                        <button class='op-hoadon-soluong-modify' title="Xóa hàng hóa" data-bind="click: $root.xoaHangHoa">
                                            <i class="material-icons">close</i>
                                        </button>

                                        <div class="gara-popup-chietkhau">
                                            <div style="display:flex; margin-bottom:5px; justify-content:space-around">
                                                <span>Chiết khấu</span>
                                                <input class="gara-input " style="width:100px; margin:0 10px; height:24px;"
                                                       onclick="this.select()"
                                                       onkeypress="keypressNumber_limitNumber(event, this)"
                                                       data-bind="attr:{id:'pri-g_' + IDRandom}, event:{keyup: $root.editSale}" />
                                                <div class="toogle toogle-report Ptram"
                                                     data-bind="attr:{id: 'vnd_'+ IDRandom}">
                                                    <span class="poison" data-bind="click: $root.clickVND">VNĐ</span>
                                                    <span class="transverse"
                                                          data-bind="click: $root.clickVND">%</span>
                                                </div>
                                            </div>
                                            <div style="display:flex; margin-bottom:5px; justify-content:space-around">
                                                <span>Thuế</span>
                                                <input class="gara-input " style="width:100px; margin:0 10px; height:24px;"
                                                       onkeypress="keypressNumber_limitNumber(event, this)"
                                                       onclick="this.select()"
                                                       data-bind="attr:{id:'ipTaxCT_' + IDRandom}, event:{keyup: $root.cthd_editThue}" />
                                                <div class="toogle toogle-report Ptram"
                                                     data-bind="css:{'active-re': PTThue > 0 || (PTThue ==0 && TienThue ==0)},attr:{id: 'taxCT_'+ IDRandom}">
                                                    <span class="poison" data-bind="click: $root.cthd_clickThue">VNĐ</span>
                                                    <span class="transverse" data-bind="click: $root.cthd_clickThue">%</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="op-hoadon-thongtinkhac">
                                <div class="flex flex-column op-hoadon-infor">
                                    <div class="op-hoadon-chietkhaunhanvien" data-bind="visible:GhiChu_NVThucHien.length>0">
                                        <small data-bind="text: GhiChu_NVThucHien"></small>
                                    </div>
                                    <div class="op-hoadon-chietkhaunhanvien" data-bind="visible:GhiChu_NVTuVan.length>0">
                                        <small data-bind="text: GhiChu_NVTuVan"></small>
                                    </div>
                                </div>
                                <div class="flex flex-column op-hoadon-quanlity">
                                    <div class="op-hoadon-thue" data-bind="visible: TienChietKhau> 0">
                                        <small>Chiết khấu:</small>
                                        <small data-bind="text: formatNumber3Digit(TienChietKhau), attr:{id:'ck_'+ IDRandom}"></small>
                                    </div>
                                    <div class="op-hoadon-thue" data-bind="visible: TienThue> 0">
                                        <small>Thuế:</small>
                                        <small data-bind="text: formatNumber3Digit(TienThue),attr:{id:'tax_'+ IDRandom}"></small>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!--/ko-->
                        <!--ko foreach: ThanhPhanComBo-->
                        <div class="op-hoadon-item ctLo" data-bind="attr:{id: IDRandom}, visible: LoaiHoaDon !==6">
                            <div class="op-hoadon-infor">
                                <div class="op-hoadon-stt">
                                </div>
                                <div class="op-hoadon-id">
                                    <span data-bind="text:MaHangHoa,attr:{title: MaHangHoa}"></span>
                                </div>
                                <div class="op-hoadon-name">
                                    <div class="flex" style="width:100%">
                                        <input type="text" class="form-control bold  border-none" onclick="this.select()"
                                               data-bind="value:TenHangHoaThayThe,
                                                attr:{id: 'ten_'+ IDRandom,title: TenHangHoaThayThe},
                                               event:{keyup: function() {$root.Combo_editTenThayThe($data, $parent, false)},
                                               mouseout: $root.mouseoutTenThayThe}" />
                                        <span class="green" data-bind="text: ThuocTinh_GiaTri"></span>
                                    </div>
                                </div>
                                <div class="op-hoadon-ghichu">
                                    <input class="input-simple" required placeholder="Ghi chú sản phẩm"
                                           data-bind="value: GhiChu, event:{keyup: function(){$root.Combo_UpdateGhiChu ($data,$parent,false)}}" />
                                    <i class="fa fa-pencil"></i>
                                </div>
                            </div>
                            <div class="op-hoadon-quanlity">
                                <div class="op-hoadon-soluong">
                                    <div class="flex">
                                        <button class='op-hoadon-soluong-modify'
                                                data-bind="click: function(){$root.Combo_giamSoLuong($data,$parent,false)}" title="giảm số lượng">
                                            <i class="fa fa-angle-down"></i>
                                        </button>
                                        <input class="input-simple height-24" onkeypress="keypressNumber_limitNumber(event, this)"
                                               onclick="this.select()"
                                               data-bind="value: formatNumber3Digit(SoLuong),
                                               attr:{id:'munber_' + IDRandom},
                                               event:{keyup: function(){$root.Combo_editSoluong($data,$parent,false)}},
                                               enable: $root.HoaDons().StatusOffline() == false" />
                                        <span class="gara-return-number" data-bind="text: '/' + formatNumber3Digit(SoLuongDaMua), visible: SoLuongDaMua > 0">/1000</span>
                                        <button class='op-hoadon-soluong-modify' data-bind="click: function(){$root.Combo_tangSoLuong($data,$parent,false)}" title="Tăng số lượng"><i class="fa fa-angle-up"></i></button>
                                    </div>

                                </div>
                                <div class="op-hoadon-dongia">
                                    <div class="flex">
                                        <!--ko if: $root.roleChangePriceProduct() -->
                                        <input class="input-simple height-24"
                                               autocomplete="off"
                                               onkeypress="return keypressNumber(event)" onclick="this.select()" maxlength="12"
                                               data-bind="value: formatNumber3Digit(GiaBan) ,
                                               attr:{id: IDRandom},
                                               event:{keyup: function(){$root.Combo_editPrice($data,$parent,false)}}, " />
                                        <!-- /ko-->
                                        <!--ko if: !$root.roleChangePriceProduct() -->
                                        <label class="input-simple height-24"
                                               data-bind="text: formatNumber3Digit(GiaBan),
                                            attr:{id:IDRandom}"></label>
                                        <!-- /ko-->
                                    </div>
                                </div>
                                <!--ko if: $root.HoaDons().ID_BaoHiem() !==null && $root.HoaDons().LoaiHoaDon() === 25 -->
                                <div class="op-hoadon-baohiem">
                                    <div class="flex ">
                                        <input class="input-simple height-24"
                                               onclick="this.select()"
                                               onkeypress="return keypressNumber(event)" />
                                    </div>
                                </div>
                                <!-- /ko-->
                                <div class="op-hoadon-thanhtoan">
                                    <div class="flex">
                                        <!-- ko if: $root.roleChangePriceProduct() -->
                                        <input class="input-simple height-24"
                                               onkeypress="return keypressNumber(event)" onclick="this.select()" maxlength="12"
                                               data-bind="value: formatNumber3Digit(ThanhToan),
                                                   attr:{id: 'sum-f_' + IDRandom},
                                                   event:{keyup: function(){$root.Combo_editSumPrice($data,$parent,false)}}, " />
                                        <!-- /ko-->
                                        <!-- ko if: !$root.roleChangePriceProduct() -->
                                        <label class="input-simple height-24"
                                               data-bind="text: formatNumber3Digit(ThanhToan), attr:{id: 'sum-f_'+ IDRandom}"></label>
                                        <!-- /ko-->
                                    </div>
                                </div>

                                <div class="op-hoadon-chucnang">
                                    <div class="flex flex-end position-relative">
                                        <button class='op-hoadon-soluong-modify' title="Định lượng"
                                                data-bind="click: function(){ $root.Combo_ShowPopChangeTPDinhLuong ($data,$parent,false )},
                            visible: !LaHangHoa">
                                            <i class=" fa fa-list font-14"></i>
                                        </button>
                                        <button class='op-hoadon-soluong-modify' style="display:none"
                                                data-bind="click: function(){ $root.Combo_ShowDivSale ($data,$parent,false )}" title="Chiết khấu hàng hóa"
                                                onclick="showPopupChietKhau()">
                                            <i class="fa fa-percent font-14"></i>
                                        </button>
                                        <button class='op-hoadon-soluong-modify' style="display:none" title="Thêm hàng hóa cùng loại">
                                            <i class="material-icons">add</i>
                                        </button>
                                        <button class='op-hoadon-soluong-modify' title="chiết khấu nhân viên"
                                                data-bind="click:function(){$root.Combo_showPopupUserDiscount($data, $parent,false)} ,
                            visible: LoaiHoaDon ==1 ||  LoaiHoaDon ==19 || LoaiHoaDon == 25">
                                            <i class="material-icons">person</i>
                                        </button>
                                        <button class='op-hoadon-soluong-modify' title="Xóa hàng hóa"
                                                data-bind="click: function(){$root.Combo_xoaHangHoa($data, $parent,false)} ">
                                            <i class="material-icons">close</i>
                                        </button>

                                        <div class="gara-popup-chietkhau">
                                            <div style="display:flex; margin-bottom:5px; justify-content:space-around">
                                                <span>Chiết khấu</span>
                                                <input class="gara-input " style="width:100px; margin:0 10px; height:24px;"
                                                       onclick="this.select()"
                                                       onkeypress="keypressNumber_limitNumber(event, this)"
                                                       data-bind="attr:{id:'pri-g_' + IDRandom},
                                   event:{keyup: function(){$root.Combo_editSale($data, $parent,false)}}" />
                                                <div class="toogle toogle-report Ptram"
                                                     data-bind="attr:{id: 'vnd_'+ IDRandom}">
                                                    <span class="poison" data-bind="click: function(){$root.Combo_clickVND($data, $parent,false)}">VNĐ</span>
                                                    <span class="transverse"
                                                          data-bind="click: function(){$root.Combo_clickVND($data, $parent,false)}">%</span>
                                                </div>
                                            </div>
                                            <div style="display:flex; margin-bottom:5px; justify-content:space-around">
                                                <span>Thuế</span>
                                                <input class="gara-input " style="width:100px; margin:0 10px; height:24px;"
                                                       onkeypress="keypressNumber_limitNumber(event, this)"
                                                       onclick="this.select()"
                                                       data-bind="attr:{id:'ipTaxCT_' + IDRandom},
                                   event:{keyup: function(){$root.Combo_editThue($data, $parent,false)}}" />
                                                <div class="toogle toogle-report Ptram"
                                                     data-bind="css:{'active-re': PTThue > 0 || (PTThue ==0 && TienThue ==0)},attr:{id: 'taxCT_'+ IDRandom}">
                                                    <span class="poison" data-bind="click: function(){$root.Combo_clickThue($data, $parent,false)}">VNĐ</span>
                                                    <span class="transverse" data-bind="click: function(){$root.Combo_clickThue($data, $parent,false)}">%</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="op-hoadon-thongtinkhac">
                                <div class="flex flex-column op-hoadon-infor">
                                    <div class="op-hoadon-chietkhaunhanvien" data-bind="visible:GhiChu_NVThucHien.length>0">
                                        <small data-bind="text: GhiChu_NVThucHien"></small>
                                    </div>
                                    <div class="op-hoadon-chietkhaunhanvien" data-bind="visible:GhiChu_NVTuVan.length>0">
                                        <small data-bind="text: GhiChu_NVTuVan"></small>
                                    </div>
                                </div>
                                <div class="flex flex-column op-hoadon-quanlity">
                                    <div class="op-hoadon-thue" data-bind="visible: TienChietKhau> 0">
                                        <small>Chiết khấu:</small>
                                        <small data-bind="text: formatNumber3Digit(TienChietKhau), attr:{id:'ck_'+ IDRandom}"></small>
                                    </div>
                                    <div class="op-hoadon-thue" data-bind="visible: TienThue> 0">
                                        <small>Thuế:</small>
                                        <small data-bind="text: formatNumber3Digit(TienThue),attr:{id:'tax_'+ IDRandom}"></small>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!--/ko-->
                        <!--hàng có lô cùng loai-->
                        <!--ko foreach: DM_LoHang-->
                        <!--ko if: $index() != 0-->
                        <div class="op-hoadon-item ctLo" data-bind="attr:{id: IDRandom}">
                            <div class="op-hoadon-infor">
                                <div class="op-hoadon-lohang">
                                    <div>
                                        <label>Lô hàng</label>
                                        <div class="dropdown">
                                            <input class="op-hoadon-lohang-input" data-toggle="dropdown" data-bind="value: MaLoHang, click: $root.LoadListLot_ofProduct, event:{keyup: $root.SearchLot_ofProduct}" />
                                            <ul class="dropdown-menu" style="width:275px; left:0" data-bind="foreach: $root.ListLot_ofProduct, visible: $root.ListLot_ofProduct().length > 0">
                                                <li>
                                                    <a data-bind="click: $root.ClickChoseLot">
                                                        <div class="flex flex-between">
                                                            <span class="bold" data-bind="text: MaLoHang">Tên lô hàng</span>
                                                            <span data-bind="text: formatNumber3Digit(TonKho)">Tồn:160,000</span>
                                                        </div>
                                                        <div class="flex flex-between">
                                                            <span>NSX:<span class="green" data-bind="text: moment(NgaySanXuat).format('DD/MM/YYYY')!='Invalid date'? moment(NgaySanXuat).format('DD/MM/YYYY'):''">20/10/2002</span></span>
                                                            <span>HSD:<span class="red" data-bind="text: moment(NgayHetHan).format('DD/MM/YYYY')!='Invalid date'? moment(NgayHetHan).format('DD/MM/YYYY'):''">20/10/2002</span></span>
                                                        </div>
                                                    </a>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                    <div>
                                        <label>NSX</label>
                                        <input class="op-hoadon-lohang-input" placeholder="Ngày SX" data-bind="visible: NgaySanXuat =='' || NgaySanXuat == null" />
                                        <div class="op-hoadon-lohang-input bg-green" data-bind=" visible: NgaySanXuat !=='' && NgaySanXuat !== null"><span data-bind="text: NgaySanXuat">20/10/2020</span></div>
                                    </div>
                                    <div>
                                        <label>HSD</label>
                                        <input class="op-hoadon-lohang-input" data-bind="visible: NgayHetHan =='' || NgayHetHan == null" placeholder="Hạn SD" />
                                        <div class="op-hoadon-lohang-input bg-red" data-bind="visible: NgayHetHan !=='' && NgayHetHan !== null">
                                            <span data-bind="text: NgayHetHan">20/10/2020</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="op-hoadon-ghichu">
                                    <input class="input-simple" required placeholder="Ghi chú sản phẩm" data-bind="value: GhiChu, event:{keyup: function(){$root.UpdateCTHD_GhiChu ($data,false)}}" />
                                    <i class="fa fa-pencil"></i>

                                </div>
                            </div>
                            <div class="op-hoadon-quanlity">
                                <div class="op-hoadon-soluong">
                                    <div class="flex">
                                        <button class='op-hoadon-soluong-modify' data-bind="click: $root.giamSoLuong"><i class="fa fa-angle-down" title="Thêm hàng hóa"></i></button>
                                        <input class="input-simple height-24" onkeypress="keypressNumber_limitNumber(event, this)" onclick="this.select()"
                                               data-bind="value: formatNumber3Digit(SoLuong),   attr:{id:'munber_'+ IDRandom},   event:{keyup: $root.editSoluong}" />
                                        <span class="gara-return-number" data-bind="text: '/' + formatNumber3Digit(SoLuongDaMua), visible: SoLuongDaMua > 0">/1000</span>
                                        <button class='op-hoadon-soluong-modify' data-bind="click: $root.tangSoLuong"><i class="fa fa-angle-up" title="Thêm hàng hóa"></i></button>
                                    </div>
                                </div>
                                <div class="op-hoadon-dongia">
                                    <div class="flex">
                                        <!-- ko if: $root.roleChangePriceProduct() -->
                                        <input class="input-simple height-24" onclick="this.select()"
                                               onkeypress="return keypressNumber(event)"
                                               data-bind="value: formatNumber3Digit(GiaBan), attr:{id: IDRandom}, event:{keyup: $root.editPrice}" />
                                        <!-- /ko-->
                                        <!-- ko if: !$root.roleChangePriceProduct()-->
                                        <label class="input-simple height-24" data-bind="text: formatNumber3Digit(GiaBan),
    attr:{id: IDRandom}"></label>
                                        <!-- /ko-->
                                    </div>
                                </div>
                                <!-- ko if: $root.HoaDons().ID_BaoHiem() !==null && $root.HoaDons().LoaiHoaDon() === 25 -->
                                <div class="op-hoadon-baohiem">
                                    <div class="flex ">
                                        <input class="input-simple height-24"
                                               onclick="this.select()"
                                               onkeypress="return keypressNumber(event)"
                                               data-bind="value: formatNumber3Digit(DonGiaBaoHiem),
                                               event:{keyup: $root.editDonGiaBaoHiem},
                                               attr:{id:'giabh_' + IDRandom}" />
                                    </div>
                                </div>
                                <!--/ko-->
                                <div class="op-hoadon-thanhtoan">
                                    <div class="flex">
                                        <!-- ko if: $root.roleChangePriceProduct() -->
                                        <input class="input-simple height-24"
                                               onkeypress="return keypressNumber(event)" onclick="this.select()" maxlength="12"
                                               data-bind="value: formatNumber3Digit(ThanhToan), attr:{id: 'sum-f_' + IDRandom},
 event:{keyup: $root.editSumPrice}" />
                                        <!-- /ko-->
                                        <!-- ko if: !$root.roleChangePriceProduct()-->
                                        <label class="input-simple height-24" data-bind="text: formatNumber3Digit(ThanhToan), attr:{id: 'sum-f_' + IDRandom}"></label>
                                        <!-- /ko-->
                                    </div>
                                </div>

                                <div class="op-hoadon-chucnang">
                                    <div class="flex flex-end position-relative">
                                        <button class='op-hoadon-soluong-modify' title="Định lượng"
                                                data-bind="click: function(){ $root.ShowPop_ChangeTPDinhLuong ($data,false )} ,
                                                visible: LoaiHangHoa == 2">
                                            <i class=" fa fa-list font-14"></i>
                                        </button>
                                        <button class='op-hoadon-soluong-modify' data-bind="click: $root.showDivSale_CTHD" title="chiết khấu hàng hóa" onclick="showPopupChietKhau()">
                                            <i class=" fa fa-percent font-14"></i>
                                        </button>
                                        <button class='op-hoadon-soluong-modify' data-bind="click: $root.addLot" title="Thêm hàng cùng loại">
                                            <i class="material-icons">add</i>
                                        </button>
                                        <button class='op-hoadon-soluong-modify' title="Chiết khấu nhân viên"
                                                data-bind="click:function(){$root.showPopupUserDiscount($data, false)} ,    visible: LoaiHoaDon ==1 ||  LoaiHoaDon ==19 || LoaiHoaDon == 25">
                                            <i class="material-icons">person</i>
                                        </button>
                                        <button class='op-hoadon-soluong-modify' title="Xóa" data-bind="click: $root.xoaHangHoa"><i class="material-icons">close</i></button>

                                        <div class="gara-popup-chietkhau">
                                            <div style="display:flex; margin-bottom:5px; justify-content:space-around">
                                                <span>Chiết khấu</span>
                                                <input class="gara-input " style="width:100px; margin:0 10px; height:24px;"
                                                       onclick="this.select()"
                                                       onkeypress="keypressNumber_limitNumber(event, this)"
                                                       data-bind="attr:{id:'pri-g_' + IDRandom}, event:{keyup: $root.editSale}" />
                                                <div class="toogle toogle-report Ptram"
                                                     data-bind="attr:{id: 'vnd_' + IDRandom}">
                                                    <span class="poison" data-bind="click: $root.clickVND">VNĐ</span>
                                                    <span class="transverse" data-bind="click:  $root.clickVND">%</span>
                                                </div>
                                            </div>
                                            <div style="display:flex; margin-bottom:5px; justify-content:space-around">
                                                <span style="  ">Thuế   </span>
                                                <input class="gara-input " style="width:100px; margin:0 10px; height:24px;"
                                                       onkeypress="keypressNumber_limitNumber(event, this)"
                                                       onclick="this.select()"
                                                       data-bind="  attr:{id:'ipTaxCT_' + IDRandom}, event:{keyup: $root.cthd_editThue},
 " />
                                                <div class="toogle toogle-report Ptram"
                                                     data-bind="css:{'active-re': PTThue > 0 || (PTThue ==0 && TienThue ==0)},    attr:{id: 'taxCT_'+ IDRandom}">
                                                    <span class="poison" data-bind="click: $root.cthd_clickThue">VNĐ</span>
                                                    <span class="transverse" data-bind="click: $root.cthd_clickThue">%</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="op-hoadon-thongtinkhac">
                                <div class="flex flex-column op-hoadon-infor">
                                    <div class="op-hoadon-chietkhaunhanvien" data-bind="visible:GhiChu_NVThucHien.length>0">
                                        <small data-bind="text: GhiChu_NVThucHien"></small>
                                    </div>
                                    <div class="op-hoadon-chietkhaunhanvien" data-bind="visible:GhiChu_NVTuVan.length>0">
                                        <small data-bind="text: GhiChu_NVTuVan"></small>
                                    </div>
                                </div>
                                <div class="flex flex-column op-hoadon-quanlity">

                                    <div class="op-hoadon-thue" data-bind="visible: TienChietKhau> 0">
                                        <small>Chiết khấu:</small>
                                        <small data-bind="text: formatNumber3Digit(TienChietKhau), attr:{id:'ck_'+ IDRandom}"></small>
                                    </div>
                                    <div class="op-hoadon-thue" data-bind="visible: TienThue> 0">
                                        <small>Thuế:</small>
                                        <small data-bind="text: formatNumber3Digit(TienThue),attr:{id:'tax_'+ IDRandom}"></small>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!--/ko-->
                        <!--/ko-->
                    </div>

                </div>

                <!--foreach hh-->
                <div class="gara-catalogies gara-return" data-bind="visible: HoaDons().LoaiHoaDon()=== 6">
                    <!--Bảng lựa chọn hàng hóa đổ vào hóa đơn - hóa đơn đổi trả-->
                    <div class="flex " style="width:100%">
                        <a class="gara-button-icon gara-expand-button up" style="display:none" onclick="expand(this)">
                            <i class="material-icons">
                                expand_less
                            </i>
                        </a>
                        <a class="gara-button-icon gara-expand-button down" onclick="collapse(this)">
                            <i class="material-icons">
                                expand_more
                            </i>
                        </a>
                        <div class="flex flex-row" style=" width:100%; padding:5px; border-bottom:1px solid #ccc">
                            <div style="  position:relative" id="elTraHang">
                                <i class="material-icons icon-searchs">search</i>
                                <input type="text" class="form-control gara-search-HH " autocomplete="off"
                                       id="txtSearchHH_TH"
                                       style="padding-left:40px; width:350px"
                                       placeholder="Tìm kiếm"
                                       v-model="query"
                                       v-on:keyup="search"
                                       v-on:keyup.13="keyEnter"
                                       v-on:keyup.up="keyUp"
                                       v-on:keyup.down="keyDown">
                                <div class="gara-search-dropbox drop-search" style="min-width:350px">
                                    <ul v-on:scroll.passive="scrollList">
                                        <li v-for="(item, index) of searchList"
                                            v-on:click="click(item)"
                                            v-bind:style="   [$root.indexFocus === index ? {'background':'#d9d9d9'} : {'background':'none'}]">
                                            <div>
                                                <span>{{item.MaHangHoa}}</span>
                                                <span style="float:right">
                                                    Tồn: {{formatNumber3Digit(item.TonKho)}}
                                                </span>
                                            </div>
                                            <div>
                                                <span style=" font-weight:bold">{{item.TenHangHoa}}</span>
                                                <span style="float:right">
                                                    Giá:  {{formatNumber3Digit(item.GiaBan)}}
                                                </span>
                                            </div>
                                            <div v-if="item.MaLoHang">
                                                <span style="color:red; font-weight:bold">	&nbsp;  </span>
                                                <span style="float:right">
                                                    Lô:  {{item.MaLoHang}}
                                                </span>
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class=" " style="height:calc(100% - 50px);overflow:auto" data-bind="foreach: NewProducts">
                        <!--Trả hàng hóa thường-->
                        <div class="op-hoadon-item ctLo" data-bind="attr:{id: IDRandom}">
                            <div class="op-hoadon-infor" data-bind="css:{'op-hanghoa-lohang': QuanLyTheoLoHang}">
                                <div class="op-hoadon-stt">
                                    <span data-bind="text:SoThuTu,, style:{'background':!LaHangHoa ?'var(--color-main)':'none', 'color': !LaHangHoa?'white':'none'}"></span>
                                </div>
                                <div class="op-hoadon-id">    <span data-bind="text:MaHangHoa,attr:{title: MaHangHoa}"></span></div>
                                <div class="op-hoadon-name">
                                    <div class="flex" style="width:100%">
                                        <input type="text" class="form-control bold  border-none" onclick="this.select()"
                                               data-bind="value:TenHangHoaThayThe,
                                                attr:{id: 'ten_'+ IDRandom,title: TenHangHoaThayThe},
                                               event:{keyup: function() {$root.editTenThayThe($data, true)},
                                               mouseout: $root.mouseoutTenThayThe}" />
                                        <span class="green" data-bind="text: ThuocTinh_GiaTri"></span>
                                    </div>
                                    <div class="dropdown">
                                        <button class="" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                            <span data-bind="text: TenDonViTinh"></span>
                                        </button>
                                        <ul class="dropdown-menu " aria-labelledby="dropdownMenuButton" data-bind="foreach: ListDonViTinh">
                                            <li data-bind="style:{'background':ID_DonViQuiDoi=== $parent.ID_DonViQuiDoi?'#ccc':''}">
                                                <a data-bind="click: function(){$root.ChangeDonViTinh($data, $parent, true)}">
                                                    <span data-bind="text: TenDonViTinh"></span>
                                                </a>
                                            </li>

                                        </ul>
                                    </div>
                                </div>
                                <div class="op-hoadon-ghichu">
                                    <input class="gara-note" placeholder="GhiChu"
                                           data-bind="value: GhiChu, event:{keyup: function(){$root.UpdateCTHD_GhiChu ($data,true)}}" />
                                    <i class="fa fa-pencil"></i>
                                </div>
                            </div>
                            <div class="op-hoadon-infor" data-bind="visible: QuanLyTheoLoHang">
                                <div class="op-hoadon-lohang " data-bind="visible: QuanLyTheoLoHang">

                                    <div>
                                        <span>Số lô</span>
                                        <div class="dropdown">
                                            <input class="op-hoadon-lohang-input" placeholder="Tên lô" data-toggle="dropdown"
                                                   data-bind="value: DM_LoHang.length > 0? DM_LoHang[0].MaLoHang:'',    click: $root.LoadListLot_ofProduct,   event:{keyup: $root.SearchLot_ofProduct}" />


                                            <ul class="dropdown-menu" style="width:275px" data-bind="foreach: $root.ListLot_ofProduct,visible: $root.ListLot_ofProduct().length > 0">
                                                <li data-bind="click: $root.ClickChoseLot_DoiTra">
                                                    <a>
                                                        <div class="flex flex-between">
                                                            <span class="bold" data-bind="text: MaLoHang">Tên lô hàng</span>
                                                            <span>
                                                                Tồn :
                                                                <span data-bind="text: formatNumber3Digit(TonKho)"></span>
                                                            </span>
                                                        </div>
                                                        <div class="flex flex-between">
                                                            <span>
                                                                NSX:
                                                                <span class="green" data-bind="text: moment(NgaySanXuat).format('DD/MM/YYYY')!='Invalid date'? moment(NgaySanXuat).format('DD/MM/YYYY'):''"></span>
                                                            </span>
                                                            <span>
                                                                HSD:
                                                                <span class="red" data-bind="text: moment(NgayHetHan).format('DD/MM/YYYY')!='Invalid date'? moment(NgayHetHan).format('DD/MM/YYYY'):''"></span>
                                                            </span>
                                                        </div>
                                                    </a>
                                                </li>

                                            </ul>
                                        </div>
                                    </div>
                                    <div>
                                        <label>Ngày SX</label>
                                        <input class="op-hoadon-lohang-input"
                                               placeholder="Ngày SX"
                                               data-bind="visible: DM_LoHang.length > 0 && (DM_LoHang[0].NgaySanXuat =='' || DM_LoHang[0].NgaySanXuat == null)" />
                                        <div class="op-hoadon-lohang-input bg-green"
                                             data-bind="text: DM_LoHang.length > 0? DM_LoHang[0].NgaySanXuat:'', visible: DM_LoHang.length > 0 && DM_LoHang[0].NgaySanXuat !='' && DM_LoHang[0].NgaySanXuat !== null"></div>
                                    </div>
                                    <div>
                                        <label>Hạn SD</label>
                                        <input class="op-hoadon-lohang-input" placeholder="Hạn SD"
                                               data-bind="visible: DM_LoHang.length > 0 && (DM_LoHang[0].NgayHetHan =='' || DM_LoHang[0].NgayHetHan == null)" />
                                        <div class="op-hoadon-lohang-input bg-red"
                                             data-bind="text: DM_LoHang.length > 0? DM_LoHang[0].NgayHetHan:'', visible: DM_LoHang.length > 0 && DM_LoHang[0].NgayHetHan !='' && DM_LoHang[0].NgayHetHan !== null"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="op-hoadon-quanlity">
                                <div class="op-hoadon-soluong">
                                    <div class="flex">
                                        <button class="op-hoadon-soluong-modify"
                                                data-bind="click: $root.giamSolLuong_DoiTra ">
                                            <i class="fa fa-angle-down" title="Thêm hàng hóa"></i>
                                        </button>
                                        <input class="input-simple height-24" onkeypress="keypressNumber_limitNumber(event, this)" onclick="this.select()"
                                               data-bind="value: formatNumber3Digit(SoLuong), attr:{id:'numberTH_' + IDRandom},
                                             event:{keyup: $root.editSoLuong_DoiTra }, enable: $root.HoaDons().StatusOffline() == false" />
                                        <button class="op-hoadon-soluong-modify" data-bind="click: $root.tangSolLuong_DoiTra ">
                                            <i class="fa fa-angle-up" title="Thêm hàng hóa"></i>
                                        </button>

                                    </div>

                                </div>
                                <div class="op-hoadon-dongia">
                                    <!--ko if: $root.roleChangePriceProduct()  -->
                                    <input class="input-simple height-24"
                                           autocomplete="off"
                                           onkeypress="return keypressNumber(event)" onclick="this.select()" maxlength="12"
                                           data-bind="value: formatNumber3Digit(GiaBan) , attr:{id: 'priceTH_'+ IDRandom},event:{keyup: $root.editPrice_DoiTra}," />
                                    <!-- /ko-->
                                    <!-- ko if: !$root.roleChangePriceProduct()-->
                                    <label class="input-simple height-24" data-bind="text: formatNumber3Digit(GiaBan),attr:{id:'priceTH_'+ IDRandom}"></label>
                                    <!-- /ko-->
                                </div>

                                <div class="op-hoadon-thanhtoan">
                                    <!--ko if: $root.roleChangePriceProduct() -->
                                    <input class="input-simple height-24"
                                           onkeypress="return keypressNumber(event)" onclick="this.select()" maxlength="12"
                                           data-bind="value: formatNumber3Digit(ThanhToan), attr:{id: 'sumTH_' + IDRandom},   event:{keyup: $root.editSumPrice_DoiTra}," />
                                    <!-- /ko-->
                                    <!--ko if: !$root.roleChangePriceProduct()-->
                                    <label class="input-simple height-24" data-bind="text: formatNumber3Digit(ThanhToan),    attr:{id: 'sumTH_'+ IDRandom}"></label>
                                    <!--/ko-->
                                </div>

                                <div class="op-hoadon-baohiem" style="display:none">
                                    <div class="flex ">
                                        <input class="input-simple height-24"
                                               onkeypress="return keypressNumber(event)"
                                               data-bind="value: formatNumber3Digit(DonGiaBaoHiem),
                                               event:{keyup: $root.editDonGiaBaoHiem},
                                               attr:{id:'giabh_' + IDRandom}">
                                    </div>
                                </div>
                                <div class="op-hoadon-chucnang">
                                    <div class="flex flex-end position-relative">
                                        <button class='op-hoadon-soluong-modify' title="Định lượng"
                                                data-bind="click: function(){ $root.ShowPop_ChangeTPDinhLuong ($data,true )} ,
                                                visible: LoaiHangHoa !=1">
                                            <i class=" fa fa-list font-14"></i>
                                        </button>
                                        <button title="Chiết khấu hàng hóa" class="op-hoadon-soluong-modify" data-bind="click: $root.showDivSale_CTHD_DoiTra" onclick="showPopupChietKhau()">
                                            <i class=" fa fa-percent font-14"></i>
                                        </button>
                                        <button title="Tạo mới" data-bind="click: $root.addLot_DoiTra" class="op-hoadon-soluong-modify">
                                            <i class="material-icons">add</i>
                                        </button>
                                        <button title="Chiết khấu nhân viên" class="op-hoadon-soluong-modify"
                                                data-bind="click:function(){$root.showPopupUserDiscount($data, true)} ,
visible: LoaiHoaDon !==3 ">
                                            <i class="material-icons">person</i>
                                        </button>
                                        <button class="op-hoadon-soluong-modify" title="Xóa" data-bind="click: $root.xoaHangHoa_DoiTra">
                                            <i class="material-icons">close</i>
                                        </button>
                                        <div class="gara-popup-chietkhau">
                                            <div class="flex flex-around" style="margin-bottom: 5px;">
                                                <span>Chiết khấu</span>
                                                <input class="gara-input" style="width:100px; margin:0 10px; height:24px;"
                                                       autocomplete="off"
                                                       onclick="this.select()"
                                                       onkeypress="keypressNumber_limitNumber(event, this)"
                                                       data-bind="attr:{id:'pri-gTH_' + IDRandom}, event:{keyup: $root.editSale_DoiTra}" />
                                                <div class="toogle toogle-report Ptram"
                                                     data-bind="attr:{id: 'vndTH_'+ IDRandom}">
                                                    <span class="poison" data-bind="click: $root.clickVND_DoiTra">VNĐ</span>
                                                    <span class="transverse"
                                                          data-bind="click: $root.clickVND_DoiTra">%</span>
                                                </div>

                                            </div>
                                            <div class="flex flex-around" style="margin-bottom: 5px;">
                                                <span>Thuế</span>
                                                <input class="gara-input" style="width:100px; margin:0 10px; height:24px;"
                                                       autocomplete="off"
                                                       onclick="this.select()"
                                                       onkeypress="return keypressNumber(event)"
                                                       data-bind="attr:{id:'ipTaxCT_' + IDRandom}, event:{keyup: $root.cthd_editThueDoiTra}" />
                                                <div class="toogle toogle-report Ptram"
                                                     data-bind="css:{'active-re': PTThue > 0 || (PTThue ==0 && TienThue ==0)},attr:{id: 'taxCT_'+ IDRandom}">
                                                    <span class="poison" data-bind="click: $root.cthd_clickThueDoiTra">VNĐ</span>
                                                    <span class="transverse" data-bind="click: $root.cthd_clickThueDoiTra">%</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="op-hoadon-thongtinkhac">
                                <div class="flex flex-column op-hoadon-infor">
                                    <div class="op-hoadon-chietkhaunhanvien" data-bind="visible:GhiChu_NVThucHien.length>0">
                                        <small data-bind="text: GhiChu_NVThucHien"></small>
                                    </div>
                                    <div class="op-hoadon-chietkhaunhanvien" data-bind="visible:GhiChu_NVTuVan.length>0">
                                        <small data-bind="text: GhiChu_NVTuVan"></small>
                                    </div>
                                </div>
                                <div class="flex flex-column op-hoadon-quanlity">
                                    <div class="op-hoadon-thue" data-bind="visible: TienChietKhau> 0">
                                        <small>Chiết khấu:</small>
                                        <small data-bind="text: formatNumber3Digit(TienChietKhau), attr:{id:'ck_'+ IDRandom}"></small>
                                    </div>
                                    <div class="op-hoadon-thue" data-bind="visible: TienThue> 0">
                                        <small>Thuế:</small>
                                        <small data-bind="text: formatNumber3Digit(TienThue),attr:{id:'tax_'+ IDRandom}"></small>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!--ko foreach: HangCungLoais-->
                        <div class="op-hoadon-item ctLo" data-bind="attr:{id: IDRandom}">
                            <div class="op-hoadon-infor">
                                <div class="op-hoadon-stt">
                                </div>
                                <div class="op-hoadon-id">
                                    <span data-bind="text:MaHangHoa,attr:{title: MaHangHoa}"></span>
                                </div>
                                <div class="op-hoadon-name">
                                    <div class="flex" style="width:100%">
                                        <input type="text" class="form-control bold  border-none" onclick="this.select()"
                                               data-bind="value:TenHangHoaThayThe,
                                                attr:{id: 'ten_'+ IDRandom,title: TenHangHoaThayThe},
                                               event:{keyup: function() {$root.editTenThayThe($data, false)},
                                               mouseout: $root.mouseoutTenThayThe}" />
                                        <span class="green" data-bind="text: ThuocTinh_GiaTri"></span>
                                    </div>
                                    <div class="dropdown" data-bind="visible: ListDonViTinh.length > 0">
                                        <a data-toggle="dropdown" class="btn btn-link height-24" data-bind="text: TenDonViTinh">
                                        </a>
                                        <ul class="dropdown-menu" data-bind="foreach: ListDonViTinh">
                                            <li data-bind="style:{'background':ID_DonViQuiDoi=== $parent.ID_DonViQuiDoi?'#ccc':''}">
                                                <a data-bind=" click: function(){$root.ChangeDonViTinh($data, $parent, true)}">
                                                    <span data-bind="text: TenDonViTinh"></span>
                                                </a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="op-hoadon-ghichu">
                                    <input class="input-simple" required="" placeholder="Ghi chú sản phẩm" data-bind="value: GhiChu, event:{keyup: function(){$root.UpdateCTHD_GhiChu ($data,true)}}" />
                                    <i class="fa fa-pencil"></i>
                                </div>
                            </div>
                            <div class="op-hoadon-quanlity">
                                <div class="op-hoadon-soluong">
                                    <div class="flex">
                                        <button class="op-hoadon-soluong-modify" data-bind="click: $root.giamSolLuong_DoiTra" title="giảm số lượng">
                                            <i class="fa fa-angle-down"></i>
                                        </button>
                                        <input class="input-simple height-24" onkeypress="keypressNumber_limitNumber(event, this)" onclick="this.select()"
                                               data-bind="value: formatNumber3Digit(SoLuong), attr:{id:'numberTH_' + IDRandom},
 event:{keyup: $root.editSoLuong_DoiTra }, enable: $root.HoaDons().StatusOffline() == false">
                                        <button class="op-hoadon-soluong-modify" data-bind="event:{click: $root.tangSolLuong_DoiTra }" title="Tăng số lượng"><i class="fa fa-angle-up"></i></button>


                                    </div>

                                </div>
                                <div class="op-hoadon-dongia">
                                    <div class="flex">
                                        <!--ko if: $root.roleChangePriceProduct()  -->
                                        <input class="input-simple height-24"
                                               autocomplete="off"
                                               onkeypress="return keypressNumber(event)" onclick="this.select()" maxlength="12"
                                               data-bind="value: formatNumber3Digit(GiaBan) , attr:{id: 'priceTH_'+ IDRandom},event:{keyup: $root.editPrice_DoiTra}, " />
                                        <!-- /ko-->
                                        <!-- ko if: !$root.roleChangePriceProduct()-->
                                        <label class="input-simple height-24" data-bind="text: formatNumber3Digit(GiaBan),    attr:{id:IDRandom}"></label>
                                        <!-- /ko-->
                                    </div>
                                </div>
                                <div class="op-hoadon-thanhtoan">
                                    <div class="flex">
                                        <!--ko if: $root.roleChangePriceProduct() -->
                                        <input class="input-simple height-24"
                                               onkeypress="return keypressNumber(event)" onclick="this.select()" maxlength="12"
                                               data-bind="value: formatNumber3Digit(ThanhToan), attr:{id: 'sum-f_' + IDRandom},   event:{keyup: $root.editSumPrice}, " />
                                        <!-- /ko-->
                                        <!--ko if: !$root.roleChangePriceProduct()-->
                                        <label class="input-simple height-24" data-bind="text: formatNumber3Digit(ThanhToan),    attr:{id: 'sum-f_'+ IDRandom}"></label>
                                        <!--/ko-->
                                    </div>
                                </div>
                                <div class="op-hoadon-baohiem" style="display:none">
                                    <div class="flex ">
                                        <input class="input-simple height-24"
                                               onkeypress="return keypressNumber(event)"
                                               data-bind="value: formatNumber3Digit(DonGiaBaoHiem),
                                               event:{keyup: $root.editDonGiaBaoHiem},
                                               attr:{id:'giabh_' + IDRandom}">
                                    </div>
                                </div>
                                <div class="op-hoadon-chucnang">
                                    <div class="flex flex-end position-relative">
                                        <button class='op-hoadon-soluong-modify' title="Định lượng"
                                                data-bind="click: function(){ $root.ShowPop_ChangeTPDinhLuong ($data,true )},
                                                visible: LoaiHangHoa!=1">
                                            <i class=" fa fa-list font-14"></i>
                                        </button>
                                        <button class="op-hoadon-soluong-modify" title="Chiết khấu hàng hóa" data-bind="click: $root.showDivSale_CTHD_DoiTra" onclick="showPopupChietKhau()">
                                            <i class=" fa fa-percent font-14"></i>
                                        </button>
                                        <button class="op-hoadon-soluong-modify" title="Tạo mới" data-bind="click: $root.addLot_DoiTra">
                                            <i class="material-icons">add</i>
                                        </button>
                                        <button class="op-hoadon-soluong-modify" title="Chiết khấu nhân viên"
                                                data-bind="click:function(){$root.showPopupUserDiscount($data, true)} ,
visible: LoaiHoaDon !== 3">
                                            <i class="material-icons">person</i>
                                        </button>
                                        <button class="op-hoadon-soluong-modify" title="Xóa" data-bind="click: $root.xoaHangHoa_DoiTra">
                                            <i class="material-icons">close</i>
                                        </button>
                                        <div class="gara-popup-chietkhau">
                                            <div class="flex flex-between">
                                                <span>Chiết khấu</span>
                                                <div class="flex flex-end">
                                                    <input class="input-simple width-75"
                                                           onclick="this.select()"
                                                           onkeypress="keypressNumber_limitNumber(event, this)"
                                                           data-bind="attr:{id:'pri-gTH_' + IDRandom}, event:{keyup: $root.editSale_DoiTra}" />
                                                    <div class="toogle toogle-report Ptram"
                                                         data-bind="attr:{id: 'vndTH_'+ IDRandom}">
                                                        <span class="poison" data-bind="click: $root.clickVND_DoiTra">VNĐ</span>
                                                        <span class="transverse"
                                                              data-bind="click: $root.clickVND_DoiTra">%</span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="flex flex-between">
                                                <span>Thuế</span>
                                                <div class="flex flex-end">
                                                    <input class="input-simple width-75"
                                                           onclick="this.select()"
                                                           onkeypress="return keypressNumber(event)"
                                                           data-bind="attr:{id:'ipTaxCT_' + IDRandom}, event:{keyup: $root.cthd_editThueDoiTra}" />
                                                    <div class="toogle toogle-report Ptram"
                                                         data-bind="css:{'active-re': PTThue > 0 || (PTThue ==0 && TienThue ==0)},attr:{id: 'taxCT_'+ IDRandom}">
                                                        <span class="poison" data-bind="click: $root.cthd_clickThueDoiTra">VNĐ</span>
                                                        <span class="transverse" data-bind="click: $root.cthd_clickThueDoiTra">%</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="op-hoadon-thongtinkhac">
                                <div class="flex flex-column op-hoadon-infor">
                                    <div class="op-hoadon-chietkhaunhanvien" data-bind="visible:GhiChu_NVThucHien.length>0">
                                        <small data-bind="text: GhiChu_NVThucHien"></small>
                                    </div>
                                    <div class="op-hoadon-chietkhaunhanvien" data-bind="visible:GhiChu_NVTuVan.length>0">
                                        <small data-bind="text: GhiChu_NVTuVan"></small>
                                    </div>
                                </div>
                                <div class="flex flex-column op-hoadon-quanlity">
                                    <div class="op-hoadon-thue" data-bind="visible: TienChietKhau> 0">
                                        <small>Chiết khấu:</small>
                                        <small data-bind="text: formatNumber3Digit(TienChietKhau), attr:{id:'ck_'+ IDRandom}"></small>
                                    </div>
                                    <div class="op-hoadon-thue" data-bind="visible: TienThue> 0">
                                        <small>Thuế:</small>
                                        <small data-bind="text: formatNumber3Digit(TienThue),attr:{id:'tax_'+ IDRandom}"></small>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!--/ko-->
                        <!--ko foreach: DM_LoHang-->
                        <!--ko if: $index() != 0-->
                        <div class="ctLo op-hoadon-item" data-bind="attr:{id: IDRandom}">
                            <div class="op-hoadon-infor">
                                <div class="op-hoadon-lohang">
                                    <div>
                                        <span>Số lô</span>
                                        <div class="dropdown">
                                            <input class="op-hoadon-lohang-input" placeholder="Tên lô" data-toggle="dropdown"
                                                   data-bind="value: MaLoHang, click: $root.LoadListLot_ofProduct,
 event:{keyup: $root.SearchLot_ofProduct}" />

                                            <ul data-bind="foreach: $root.ListLot_ofProduct, visible: $root.ListLot_ofProduct().length > 0" class="dropdown-menu" style="width:275px">
                                                <li data-bind="click: $root.ClickChoseLot_DoiTra">
                                                    <a>
                                                        <div class="flex flex-between">
                                                            <span class="bold" data-bind="text: MaLoHang">Tên lô hàng</span>
                                                            <span data-bind="text: formatNumber3Digit(TonKho)">Tồn:160,000</span>
                                                        </div>
                                                        <div class="flex flex-between">
                                                            <span>NSX:<span class="green" data-bind="text: moment(NgaySanXuat).format('DD/MM/YYYY')!='Invalid date'? moment(NgaySanXuat).format('DD/MM/YYYY'):''">20/10/2002</span></span>
                                                            <span>HSD:<span class="red" data-bind="text: moment(NgayHetHan).format('DD/MM/YYYY')!='Invalid date'? moment(NgayHetHan).format('DD/MM/YYYY'):''">20/10/2002</span></span>
                                                        </div>
                                                    </a>
                                                </li>
                                            </ul>
                                        </div>

                                    </div>
                                    <div>

                                    </div>
                                    <div>
                                        <label>Ngày SX</label>
                                        <input class="op-hoadon-lohang-input" placeholder="Ngày SX"
                                               data-bind="visible: NgaySanXuat =='' || NgaySanXuat == null" />
                                        <div class="op-hoadon-lohang-input bg-green"
                                             data-bind="text: NgaySanXuat, visible: NgaySanXuat !=='' && NgaySanXuat !== null"></div>
                                    </div>
                                    <div>
                                        <label>Hạn SD</label>
                                        <input class="op-hoadon-lohang-input " placeholder="Hạn SD"
                                               data-bind="visible: NgayHetHan =='' || NgayHetHan == null" />
                                        <div class="op-hoadon-lohang-input bg-red"
                                             data-bind="text: NgayHetHan, visible: NgayHetHan !=='' && NgayHetHan !== null"></div>
                                    </div>
                                </div>

                                <div class="op-hoadon-ghichu">
                                    <input class="input-simple" placeholder="Ghi chú" autocomplete="off"
                                           data-bind="value: GhiChu, event:{keyup: function(){$root.UpdateCTHD_GhiChu ($data,true)}}" />
                                    <i class="fa fa-pencil"></i>
                                </div>
                            </div>
                            <div class="op-hoadon-quanlity">
                                <div class="op-hoadon-soluong">
                                    <div class="flex">
                                        <button class="op-hoadon-soluong-modify" data-bind="click: $root.giamSolLuong_DoiTra" title="giảm số lượng">
                                            <i class="fa fa-angle-down"></i>
                                        </button>
                                        <input class="input-simple height-24" onkeypress="keypressNumber_limitNumber(event, this)" onclick="this.select()"
                                               data-bind="value: formatNumber3Digit(SoLuong), attr:{id:'numberTH_' + IDRandom},
 event:{keyup: $root.editSoLuong_DoiTra }, enable: $root.HoaDons().StatusOffline() == false">
                                        <button class="op-hoadon-soluong-modify" data-bind="event:{click: $root.tangSolLuong_DoiTra }" title="Tăng số lượng"><i class="fa fa-angle-up"></i></button>


                                    </div>

                                </div>
                                <div class="op-hoadon-dongia">
                                    <div class="flex">
                                        <!--ko if: $root.roleChangePriceProduct()  -->
                                        <input class="input-simple height-24"
                                               autocomplete="off"
                                               onkeypress="return keypressNumber(event)" onclick="this.select()" maxlength="12"
                                               data-bind="value: formatNumber3Digit(GiaBan) , attr:{id: 'priceTH_'+ IDRandom},event:{keyup: $root.editPrice_DoiTra}, " />
                                        <!-- /ko-->
                                        <!-- ko if: !$root.roleChangePriceProduct()-->
                                        <label class="input-simple height-24" data-bind="text: formatNumber3Digit(GiaBan),    attr:{id:IDRandom}"></label>
                                        <!-- /ko-->
                                    </div>
                                </div>
                                <div class="op-hoadon-thanhtoan">
                                    <div class="flex">
                                        <!--ko if: $root.roleChangePriceProduct() -->
                                        <input class="input-simple height-24"
                                               onkeypress="return keypressNumber(event)" onclick="this.select()" maxlength="12"
                                               data-bind="value: formatNumber3Digit(ThanhToan), attr:{id: 'sum-f_' + IDRandom},   event:{keyup: $root.editSumPrice}, " />
                                        <!-- /ko-->
                                        <!--ko if: !$root.roleChangePriceProduct()-->
                                        <label class="input-simple height-24" data-bind="text: formatNumber3Digit(ThanhToan),    attr:{id: 'sum-f_'+ IDRandom}"></label>
                                        <!--/ko-->
                                    </div>
                                </div>
                                <div class="op-hoadon-baohiem" style="display:none">
                                    <div class="flex ">
                                        <input class="input-simple height-24"
                                               onkeypress="return keypressNumber(event)"
                                               data-bind="value: formatNumber3Digit(DonGiaBaoHiem),
                                               event:{keyup: $root.editDonGiaBaoHiem},
                                               attr:{id:'giabh_' + IDRandom}">
                                    </div>
                                </div>
                                <div class="op-hoadon-chucnang">
                                    <div class="flex flex-end position-relative">
                                        <button class='op-hoadon-soluong-modify' title="Định lượng"
                                                data-bind="click: function(){ $root.ShowPop_ChangeTPDinhLuong ($data,true )} ,
                                                visible: LoaiHangHoa!=1">
                                            <i class=" fa fa-list font-14"></i>
                                        </button>
                                        <button class="op-hoadon-soluong-modify" title="Chiết khấu hàng hóa" data-bind="click: $root.showDivSale_CTHD_DoiTra" onclick="showPopupChietKhau()">
                                            <i class=" fa fa-percent font-14"></i>
                                        </button>
                                        <button class="op-hoadon-soluong-modify" title="Tạo mới" data-bind="click: $root.addLot_DoiTra">
                                            <i class="material-icons">add</i>
                                        </button>
                                        <button class="op-hoadon-soluong-modify" title="Chiết khấu nhân viên"
                                                data-bind="click:function(){$root.showPopupUserDiscount($data, true)} ,
visible: LoaiHoaDon !==3">
                                            <i class="material-icons">person</i>
                                        </button>
                                        <button class="op-hoadon-soluong-modify" title="Xóa" data-bind="click: $root.xoaHangHoa_DoiTra">
                                            <i class="material-icons">close</i>
                                        </button>
                                        <div class="gara-popup-chietkhau">
                                            <div class="flex flex-between">
                                                <span>Chiết khấu</span>
                                                <div class="flex flex-end">
                                                    <input class="input-simple width-75"
                                                           onclick="this.select()"
                                                           onkeypress="keypressNumber_limitNumber(event, this)"
                                                           data-bind="attr:{id:'pri-gTH_' + IDRandom}, event:{keyup: $root.editSale_DoiTra}" />
                                                    <div class="toogle toogle-report Ptram"
                                                         data-bind="attr:{id: 'vndTH_'+ IDRandom}">
                                                        <span class="poison" data-bind="click: $root.clickVND_DoiTra">VNĐ</span>
                                                        <span class="transverse"
                                                              data-bind="click: $root.clickVND_DoiTra">%</span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="flex flex-between">
                                                <span>Thuế</span>
                                                <div class="flex flex-end">
                                                    <input class="input-simple width-75"
                                                           onclick="this.select()"
                                                           onkeypress="return keypressNumber(event)"
                                                           data-bind="attr:{id:'ipTaxCT_' + IDRandom}, event:{keyup: $root.cthd_editThueDoiTra}" />
                                                    <div class="toogle toogle-report Ptram"
                                                         data-bind="css:{'active-re': PTThue > 0 || (PTThue ==0 && TienThue ==0)},attr:{id: 'taxCT_'+ IDRandom}">
                                                        <span class="poison" data-bind="click: $root.cthd_clickThueDoiTra">VNĐ</span>
                                                        <span class="transverse" data-bind="click: $root.cthd_clickThueDoiTra">%</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="op-hoadon-thongtinkhac">
                                <div class="flex flex-column op-hoadon-infor">
                                    <div class="op-hoadon-chietkhaunhanvien" data-bind="visible:GhiChu_NVThucHien.length>0">
                                        <small data-bind="text: GhiChu_NVThucHien"></small>
                                    </div>
                                    <div class="op-hoadon-chietkhaunhanvien" data-bind="visible:GhiChu_NVTuVan.length>0">
                                        <small data-bind="text: GhiChu_NVTuVan"></small>
                                    </div>
                                </div>
                                <div class="flex flex-column op-hoadon-quanlity">
                                    <div class="op-hoadon-thue" data-bind="visible: TienChietKhau> 0">
                                        <small>Chiết khấu:</small>
                                        <small data-bind="text: formatNumber3Digit(TienChietKhau), attr:{id:'ck_'+ IDRandom}"></small>
                                    </div>
                                    <div class="op-hoadon-thue" data-bind="visible: TienThue> 0">
                                        <small>Thuế:</small>
                                        <small data-bind="text: formatNumber3Digit(TienThue),attr:{id:'tax_'+ IDRandom}"></small>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!--/ko-->
                        <!--/ko-->
                        <!--ko foreach: ThanhPhanComBo-->
                        <div class="op-hoadon-item ctLo" data-bind="attr:{id: IDRandom}">
                            <div class="op-hoadon-infor">
                                <div class="op-hoadon-stt">
                                </div>
                                <div class="op-hoadon-id">
                                    <span data-bind="text:MaHangHoa,attr:{title: MaHangHoa}"></span>
                                </div>
                                <div class="op-hoadon-name">
                                    <div class="flex" style="width:100%">
                                        <input type="text" class="form-control bold  border-none" onclick="this.select()"
                                               data-bind="value:TenHangHoaThayThe,
                                               attr:{id: 'ten_'+ IDRandom,title: TenHangHoaThayThe},
                                               event:{keyup: function() {$root.Combo_editTenThayThe($data, $parent, true)},
                                               mouseout: $root.mouseoutTenThayThe}" />
                                        <span class="green" data-bind="text: ThuocTinh_GiaTri"></span>
                                    </div>
                                    <div class="dropdown" data-bind="visible: ListDonViTinh.length > 0">
                                        <a data-toggle="dropdown" class="btn btn-link height-24" data-bind="text: TenDonViTinh">
                                        </a>
                                        <ul class="dropdown-menu" data-bind="foreach: ListDonViTinh">
                                            <li data-bind="style:{'background':ID_DonViQuiDoi=== $parent.ID_DonViQuiDoi?'#ccc':''}">
                                                <a data-bind=" click: function(){$root.ChangeDonViTinh($data, $parent, true)}">
                                                    <span data-bind="text: TenDonViTinh"></span>
                                                </a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="op-hoadon-ghichu">
                                    <input class="input-simple" required="" placeholder="Ghi chú sản phẩm"
                                           data-bind="value: GhiChu, event:{keyup: function(){$root.Combo_UpdateGhiChu ($data,$parent,true)}}" />
                                    <i class="fa fa-pencil"></i>
                                </div>
                            </div>
                            <div class="op-hoadon-quanlity">
                                <div class="op-hoadon-soluong">
                                    <div class="flex">
                                        <button class="op-hoadon-soluong-modify" title="giảm số lượng"
                                                data-bind="click: function(){$root.Combo_giamSoLuong($data,$parent,true)}">
                                            <i class="fa fa-angle-down"></i>
                                        </button>
                                        <input class="input-simple height-24" onkeypress="keypressNumber_limitNumber(event, this)" onclick="this.select()"
                                               data-bind="value: formatNumber3Digit(SoLuong),
                                               attr:{id:'numberTH_' + IDRandom},
                                                event:{keyup: function(){$root.Combo_editSoluong($data,$parent,true)}},
                                               enable: $root.HoaDons().StatusOffline() == false">
                                        <button class="op-hoadon-soluong-modify" title="Tăng số lượng"
                                                data-bind="click: function(){$root.Combo_tangSoLuong($data,$parent,true)}">
                                            <i class="fa fa-angle-up"></i>
                                        </button>


                                    </div>

                                </div>
                                <div class="op-hoadon-dongia">
                                    <div class="flex">
                                        <!--ko if: $root.roleChangePriceProduct()  -->
                                        <input class="input-simple height-24"
                                               autocomplete="off"
                                               onkeypress="return keypressNumber(event)" onclick="this.select()" maxlength="12"
                                               data-bind="value: formatNumber3Digit(GiaBan) ,
                                               attr:{id: 'priceTH_'+ IDRandom},
                                               event:{keyup: function(){$root.Combo_editPrice($data,$parent,true)}} " />
                                        <!-- /ko-->
                                        <!-- ko if: !$root.roleChangePriceProduct()-->
                                        <label class="input-simple height-24" data-bind="text: formatNumber3Digit(GiaBan),    attr:{id:IDRandom}"></label>
                                        <!-- /ko-->
                                    </div>
                                </div>
                                <div class="op-hoadon-thanhtoan">
                                    <div class="flex">
                                        <!--ko if: $root.roleChangePriceProduct() -->
                                        <input class="input-simple height-24"
                                               onkeypress="return keypressNumber(event)" onclick="this.select()" maxlength="12"
                                               data-bind="value: formatNumber3Digit(ThanhToan), attr:{id: 'sum-f_' + IDRandom},
                                               event:{keyup: function(){$root.Combo_editSumPrice($data,$parent,true)}} " />
                                        <!-- /ko-->
                                        <!--ko if: !$root.roleChangePriceProduct()-->
                                        <label class="input-simple height-24" data-bind="text: formatNumber3Digit(ThanhToan),
                                               attr:{id: 'sum-f_'+ IDRandom}"></label>
                                        <!--/ko-->
                                    </div>
                                </div>
                                <div class="op-hoadon-chucnang">
                                    <div class="flex flex-end position-relative">
                                        <button class='op-hoadon-soluong-modify' title="Định lượng"
                                                data-bind="click: function(){ $root.Combo_ShowPopChangeTPDinhLuong ($data,$parent,true )},
                                                visible: !LaHangHoa">
                                            <i class=" fa fa-list font-14"></i>
                                        </button>
                                        <button class="op-hoadon-soluong-modify" title="Chiết khấu hàng hóa" style="display:none"
                                                onclick="showPopupChietKhau()">
                                            <i class=" fa fa-percent font-14"></i>
                                        </button>
                                        <button class="op-hoadon-soluong-modify" title="Tạo mới" style="display:none">
                                            <i class="material-icons">add</i>
                                        </button>
                                        <button class="op-hoadon-soluong-modify" title="Chiết khấu nhân viên"
                                                data-bind="click:function(){$root.Combo_showPopupUserDiscount($data, $parent,true)} ,
visible: LoaiHoaDon !== 3">
                                            <i class="material-icons">person</i>
                                        </button>
                                        <button class="op-hoadon-soluong-modify" title="Xóa"
                                                data-bind="click: function(){$root.Combo_xoaHangHoa($data, $parent,true)}">
                                            <i class="material-icons">close</i>
                                        </button>
                                        <div class="gara-popup-chietkhau">
                                            <div class="flex flex-between">
                                                <span>Chiết khấu</span>
                                                <div class="flex flex-end">
                                                    <input class="input-simple width-75"
                                                           onclick="this.select()"
                                                           onkeypress="keypressNumber_limitNumber(event, this)"
                                                           data-bind="attr:{id:'pri-gTH_' + IDRandom},
                                                           event:{keyup: function(){$root.Combo_editSale($data,$parent,true)}}" />
                                                    <div class="toogle toogle-report Ptram"
                                                         data-bind="attr:{id: 'vndTH_'+ IDRandom}">
                                                        <span class="poison"
                                                              data-bind="click: function(){$root.Combo_clickVND($data, $parent,true)}">VNĐ</span>
                                                        <span class="transverse"
                                                              data-bind="click: function(){$root.Combo_clickVND($data, $parent,true)}">%</span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="flex flex-between">
                                                <span>Thuế</span>
                                                <div class="flex flex-end">
                                                    <input class="input-simple width-75"
                                                           onclick="this.select()"
                                                           onkeypress="return keypressNumber(event)"
                                                           data-bind="attr:{id:'ipTaxCT_' + IDRandom},
                                                           event:{keyup: function(){$root.Combo_editThue($data,$parent,true)}}" />
                                                    <div class="toogle toogle-report Ptram"
                                                         data-bind="css:{'active-re': PTThue > 0 || (PTThue ==0 && TienThue ==0)},attr:{id: 'taxCT_'+ IDRandom}">
                                                        <span class="poison" data-bind="click: function(){$root.Combo_clickThue($data, $parent,true)}">VNĐ</span>
                                                        <span class="transverse" data-bind="click: function(){$root.Combo_clickThue($data, $parent,true)}">%</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="op-hoadon-thongtinkhac">
                                <div class="flex flex-column op-hoadon-infor">
                                    <div class="op-hoadon-chietkhaunhanvien" data-bind="visible:GhiChu_NVThucHien.length>0">
                                        <small data-bind="text: GhiChu_NVThucHien"></small>
                                    </div>
                                    <div class="op-hoadon-chietkhaunhanvien" data-bind="visible:GhiChu_NVTuVan.length>0">
                                        <small data-bind="text: GhiChu_NVTuVan"></small>
                                    </div>
                                </div>
                                <div class="flex flex-column op-hoadon-quanlity">
                                    <div class="op-hoadon-thue" data-bind="visible: TienChietKhau> 0">
                                        <small>Chiết khấu:</small>
                                        <small data-bind="text: formatNumber3Digit(TienChietKhau), attr:{id:'ck_'+ IDRandom}"></small>
                                    </div>
                                    <div class="op-hoadon-thue" data-bind="visible: TienThue> 0">
                                        <small>Thuế:</small>
                                        <small data-bind="text: formatNumber3Digit(TienThue),attr:{id:'tax_'+ IDRandom}"></small>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!--/ko-->
                    </div>

                </div>
            </div>
            <div class="gara-col-right bill-information">
                @*<div style="height:calc(100% - 90px) ">*@
                <div style="height:100%;display:flex; flex-direction:column">
                    <div class="gara-bill-type">
                        <!--ko if: RoleInsert_Invoice () && $root.HoaDons().LoaiHoaDon() !== 6-->
                        <!--ko if: !(
                          $root.HoaDons().ID()!=='00000000-0000-0000-0000-000000000000'
                        && ($root.HoaDons().LoaiHoaDon() == 3 || $root.HoaDons().LoaiHoaDon() == 19)
                           ) -->
                        <a data-bind="css:{'active': $root.HoaDons().LoaiHoaDon() == 1 || $root.HoaDons().LoaiHoaDon() == 25},  click: clickHoaDon">
                            <img hidden="" class="act-l" src="/Content/images/conner-white.png" alt="" tabindex="-1">
                            Hóa đơn
                            <img hidden="" class="act-r" src="/Content/images/conner-white.png" alt="" tabindex="-1">
                        </a>
                        <!--/ko-->
                        <!--/ko-->
                        <!--ko if: RoleInsert_Order() && $root.HoaDons().LoaiHoaDon() !== 6 -->
                        <!--ko if: !(
                            $root.HoaDons().ID()!=='00000000-0000-0000-0000-000000000000'
                        &&  ($root.HoaDons().LoaiHoaDon() == 1 || $root.HoaDons().LoaiHoaDon() == 19)  ) -->
                        <a data-bind="css:{'active': $root.HoaDons().LoaiHoaDon() == 3}, click: clickDatHang">
                            <img hidden="" class="act-l" src="/Content/images/conner-white.png" alt="" tabindex="-1">
                            Báo giá
                            <img hidden="" class="act-r" src="/Content/images/conner-white.png" alt="" tabindex="-1">
                        </a>
                        <!--/ko-->
                        <!--/ko-->
                        <!--ko if: $root.HoaDons().LoaiHoaDon() === 6-->
                        <a data-bind="css:{'active': $root.HoaDons().LoaiHoaDon() == 6}">
                            <img hidden="" class="act-l" src="/Content/images/conner-white.png" alt="" tabindex="-1">
                            Trả hàng
                            <img hidden="" class="act-r" src="/Content/images/conner-white.png" alt="" tabindex="-1">
                        </a>
                        <!--/ko-->
                        <!--ko if: RoleInsert_Return() && $root.HoaDons().LoaiHoaDon() !== 6 -->
                        <!--ko if: !(
                          $root.HoaDons().ID()!=='00000000-0000-0000-0000-000000000000'
                        && ($root.HoaDons().LoaiHoaDon() == 3 || $root.HoaDons().LoaiHoaDon() == 1|| $root.HoaDons().LoaiHoaDon() == 25)
                           ) -->
                        <a data-bind="css:{'active': $root.HoaDons().LoaiHoaDon() == 19},
                           click: clickGoiDichVu">
                            <img hidden="" class="act-l" src="/Content/images/conner-white.png" alt="" tabindex="-1">
                            Gói bảo dưỡng
                            <img hidden="" class="act-r" src="/Content/images/conner-white.png" alt="" tabindex="-1">
                        </a>
                        <!--/ko-->
                        <!--/ko-->
                    </div>
                    <!--Thông tin khách hàng-->
                    <div class="gara-bill-infor">
                        <jqauto-customer params="showDiv: (ChiTietDoiTuong() == null
                          || (ChiTietDoiTuong() != null && ChiTietDoiTuong().length == 0))
                          && (HoaDons().ID_HoaDon() == null || HoaDons().ID_HoaDon() =='00000000-0000-0000-0000-000000000000' ),
                          loaiDoiTuong :1,
                          roleAdd: roleCustomer_Insert(),
                          showDiary: true,
                          changeCus: ChangeCus,
                          addCustomer: showPopupAddKH"></jqauto-customer>
                        <div class="gara-bill-khachle"
                             data-bind="visible: HoaDons().ID_HoaDon()!= null && HoaDons().ID_HoaDon()!= '00000000-0000-0000-0000-000000000000' && (ChiTietDoiTuong()==null || (ChiTietDoiTuong()!=null && ChiTietDoiTuong().length == 0))">
                            <i class="fa fa-user"></i>
                            <a style="position:absolute ; width:375px">Khách Lẻ</a>
                        </div>
                        <div class="gara-bill-infor-button gara-customer-infor"
                             data-bind="foreach: ChiTietDoiTuong, visible: ChiTietDoiTuong()!=null && ChiTietDoiTuong().length > 0">
                            <label class="gara-search-HH"
                                   data-bind="text: TenDoiTuong, click: $root.showPopupEditKH"></label>
                            <div>
                                <a title="Gói bảo dưỡng"
                                   data-bind="click: $root.ShowPopListDiary_ofCustomer,
                                   ">
                                    <i class="fal fa-book"></i>
                                    <span class="badge-baoduong"
                                          data-bind="text: $root.TongGoiDV(), visible: $root.TongGoiDV() > 0">
                                    </span>
                                </a>
                                <a href="javascript:void(0)" data-bind="click: $parent.deleteNCC">
                                    <i class="material-icons">close</i>
                                </a>
                            </div>
                            <div class="gara-customer-point"
                                 data-bind="visible: $root.ChiTietDoiTuong() && ($root.ChiTietDoiTuong()[0].TongTichDiem > 0 ||  $root.ChiTietDoiTuong()[0].NoHienTai  > 0)">
                                <div data-bind="visible: $root.ChiTietDoiTuong() && $root.ChiTietDoiTuong()[0].NoHienTai > 0">
                                    <span>Nợ: </span>
                                    <span data-bind="text: $root.ChiTietDoiTuong()?formatNumber3Digit($root.ChiTietDoiTuong()[0].NoHienTai):''"></span>
                                </div>
                                <div data-bind="visible: $root.ChiTietDoiTuong() && $root.ChiTietDoiTuong()[0].TongTichDiem > 0">
                                    <span>Điểm: </span>
                                    <span data-bind="text: $root.ChiTietDoiTuong()?formatNumber3Digit($root.ChiTietDoiTuong()[0].TongTichDiem):''"></span>
                                </div>
                            </div>
                        </div>
                        <div class="gara-bill-infor-button" id="jqAutoPhieuTN"
                             data-bind="visible: HoaDons().LoaiHoaDon()!==6 && HoaDons().LoaiHoaDon() !== 19">
                            <div style="display:flex">

                                <a href="javascript:void(0)" title="Chọn báo giá"
                                   style="display:none"
                                   data-bind="click: GetBaoGia_byPhieuTiepNhan">
                                    <i class="material-icons">content_paste</i>
                                </a>
                                <a title="Thông tin phiếu tiếp nhận"
                                   data-bind="click: XemThongTinPhieuTiepNhan, visible: HoaDons().ID_PhieuTiepNhan() !== null">
                                    <i class="material-icons">book</i>
                                </a>
                                <a title="Lịch bảo dưỡng"
                                   data-bind="click: $root.showLichBaoDuong,
                                   visible: $root.HoaDons().ID_PhieuTiepNhan() !== null">
                                    <i class="fal fa-bell"></i>
                                    <style>
                                        .badge-baoduong {
                                            height: 18px;
                                            width: 22px;
                                            background: #fff;
                                            position: absolute;
                                            top: 0px;
                                            border-radius: 20px;
                                            line-height: 19px;
                                            text-align: center;
                                            border: 1px solid #ccc;
                                            font-weight: 700;
                                            color: black;
                                            background: pink;
                                        }
                                    </style>
                                    <span class="badge-baoduong"
                                          data-bind="visible: $root.BaoDuong_TongPhuTung() > 0,
                                          text: $root.BaoDuong_TongPhuTung,
                                          ">
                                    </span>
                                </a>
                            </div>
                            <input class="gara-search-HH" placeholder="Mã phiếu tiếp nhận" onclick="this.select()"
                                   data-bind="value: textSearchPhieuTN,
 event: {keyup: searchPhieuTiepNhan}, valueUpdate: 'afterkeydown',
                                   " />
                            <div class="gara-search-dropbox">
                                <ul data-bind="foreach: ListPhieuTiepNhan">
                                    <li data-bind="click: $root.ChosePhieuTiepNhan,
 style:{background: $root.indexFocus_phieuTN() === $index()?'#d9d9d9':'none'}">
                                        <div>
                                            <span style="color:var(--color-main)" data-bind="text: MaPhieuTiepNhan"></span>
                                            <span style="float:right">
                                                <span> Biển số xe:</span>
                                                <span data-bind="text: BienSo"></span>
                                            </span>
                                        </div>
                                    </li>
                                </ul>
                            </div>
                        </div>

                        <div data-bind="visible: $root.HoaDons().LoaiHoaDon() === 19">
                            <div class="gara-bill-infor-button" id="jqAutoSearchCar">
                                <div v-on:click="addNewCar">
                                    <a href="javascript:void(0)">
                                        <i class="material-icons">add</i>
                                    </a>
                                </div>
                                <input type="text" class="form-control gara-search-HH bold " autocomplete="off"
                                       id="txtSearchCar" placeholder="Tìm kiếm xe"
                                       v-model="query"
                                       v-on:click="showList"
                                       v-on:keyup="search"
                                       v-on:keyup.13="keyEnter"
                                       v-on:keyup.up="keyUp"
                                       v-on:keyup.down="keyDown" style="margin:-5px 0">
                                <div class="gara-search-dropbox">
                                    <ul>
                                        <li v-for="(item, index) of searchList"
                                            v-on:click="click(item)"
                                            v-bind:style="   [$root.indexFocus === index ? {'background':'#d9d9d9'} : {'background':'none'}]">
                                            <div>
                                                <span style="color:var(--color-main)">Biển số: {{item.BienSo}}</span>
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="gara-bill-content" style="display:flex; justify-content:space-between; padding:7px 15px 0 15px;">
                        <div class="gara-bangia">
                            <a class="gara-chinhanh-picker" data-bind="click: HideShow_ListBangGia">
                                <i class="material-icons" style="font-size:18px; padding:6px;">bookmark</i>
                                <span style="padding:6px 3px; color : #686868" data-bind="text: titleGiaban"></span>
                                <i class="material-icons">expand_more</i>
                                <i class="material-icons" style="display:none">expand_less</i>
                            </a>
                            <div class="gara-list-drop" hidden>
                                <div style="position:relative">
                                    <i class="material-icons" style="    position: absolute;    top: 4px;    left: 4px;    color: #686868;">search</i>
                                    <input style="padding-left:30px;" class="form-control" placeholder="Chọn bảng giá" />
                                </div>
                                <ul data-bind="foreach: arrFilterGiaBan">
                                    <li data-bind="click: $parent.ChangeBangGia">
                                        <a href="javascript:void(0)" data-bind="text: TenGiaBan"></a>
                                        <span data-bind="visible: $root.selectedGiaBan() == ID">
                                            <i class="fa fa-check pull-right my-fa-check" style="display:block"></i>
                                        </span>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="gara-bill-datetime">
                            <input id="datepicker" data-bind="value: HoaDons().NgayLapHoaDon() == null?
    DateHDDefault: moment(HoaDons().NgayLapHoaDon(),'YYYY-MM-DD HH:mm').format('DD/MM/YYYY HH:mm') .split(' ')[0],
   event:{change: ChangeNgayLapHD}" tabindex="0" title="Nhập ngày" />
                            <input id="timepicker" onclick="this.select()" data-bind="value: HoaDons().NgayLapHoaDon() == null? TimeHDDefault: HoaDons().NgayLapHoaDon().split(' ')[1],
event:{change: ChangeNgayLapHD}" tabindex="0" title="Nhập giờ" />
                            <script>
                                $(function () {
                                    $('#datepicker').datetimepicker(
                                        {
                                            format: "d/m/Y",
                                            defaultDate: new Date(),
                                            mask: true,
                                            maxDate: new Date(),
                                            timepicker: false,
                                            scrollMonth: false,
                                        });
                                    $('#timepicker').datetimepicker(
                                        {
                                            format: "H:i",
                                            step: 15,
                                            datepicker: false,
                                        });
                                });
                            </script>
                        </div>
                    </div>
                    <div style="overflow:auto; height:100%">
                        <!--Thông tin trả hàng-->
                        <div style=" " class="gara-bill-summary">
                            <div class="gara-bill-summary-main"
                                 data-bind="visible: HoaDons().LoaiHoaDon()=== 6 && HoaDons().ID_HoaDon()!=='00000000-0000-0000-0000-000000000000'">
                                <label>Thông tin trả hàng</label>
                                <div data-bind="visible: HoaDons().MaHoaDonTraHang() && HoaDons().LoaiHoaDon()===6">
                                    <div class="gara-bill-result">
                                        <label>Mã hóa đơn gốc</label>
                                        <span data-bind="text: HoaDons().MaHoaDonTraHang()"></span>
                                    </div>
                                </div>
                                <div>
                                    <div class="gara-bill-result">
                                        <label>Tổng gốc hàng trả</label>
                                        <span data-bind="text: formatNumber3Digit(HoaDons().TongGiaGocHangTra(),2)"></span>
                                    </div>
                                </div>
                                <div>
                                    <div class="gara-bill-result">
                                        <label>Thuế (VAT)</label>
                                        <span data-bind="text: formatNumber3Digit(HoaDons().TongThueDB(),2)"></span>
                                    </div>
                                </div>
                                <div>
                                    <div class="gara-bill-result">
                                        <label>Giảm giá</label>
                                        <span data-bind="text: formatNumber3Digit(HoaDons().TongGiamGiaDB(),2)">123456</span>
                                    </div>
                                </div>
                                <div>
                                    <div class="gara-bill-result">
                                        <label>Phí trả hàng</label>
                                        <input onkeypress="return keypressNumber(event)"
                                               data-bind="value: formatNumber3Digit(HoaDons().TongChiPhiHangTra(),2), event:{keyup: editPhiTraHang}" />
                                    </div>
                                </div>
                                <div>
                                    <div class="gara-bill-result">
                                        <label>Tổng tiền trả</label>
                                        <span data-bind="text:formatNumber3Digit(HoaDons().TongTienTra(),2)">123456</span>
                                    </div>
                                </div>
                            </div>
                            <div class="gara-bill-summary-main">
                                <label data-bind="visible: HoaDons().LoaiHoaDon()=== 6">Thông tin hàng mua</label>
                                <div>
                                    <div class="gara-bill-result" data-bind="click: ShowDiv_ChietKhauHangHoa">
                                        <span>
                                            <span>
                                                Chiết khấu hàng hóa
                                            </span>
                                            <span data-bind="visible: HoaDons().PTChietKhauHH()> 0, text: '('+  formatNumber3Digit(HoaDons().PTChietKhauHH()) + '%)'">
                                            </span>
                                        </span>
                                        <input data-bind="value: formatNumber3Digit(HoaDons().TongGiamGiaHang(),2)" />
                                    </div>
                                    <div class="gara-popup-bill" hidden>
                                        <div class="flex flex-between" style="flex-wrap:nowrap">
                                            <label>Chiết khấu</label>
                                            <div class="flex flex-end">
                                                <div class="flex op-js-css-toggle-option ">
                                                    <a class="gara-VAT-VND" data-bind="click: ChietKhauHangHoa_ClickTaxVND">VND</a>
                                                    <a class="gara-VAT-percent" id="ckHang_Ptram" data-bind="click: ChietKhauHangHoa_ClickTaxPtram">%</a>
                                                </div>
                                                <input class="input-simple width-75 text-right" onclick="this.select()"
                                                       onkeypress="keypressNumber_limitNumber(event, this)"
                                                       data-bind="value: HoaDons().PTChietKhauHH() > 0 ? formatNumber3Digit(HoaDons().PTChietKhauHH()):
                                               formatNumber3Digit(HoaDons().TongGiamGiaHang(),2),
   event:{keyup:ChietKhauHangHoa_Edit}," />

                                            </div>
                                        </div>
                                        <div class="flex flex-between" style="flex-wrap:nowrap; display:none">
                                            <label>Khuyến mại</label>
                                            <input class="input-simple width-75 text-right" readonly
                                                   data-bind="value: formatNumber3Digit(HoaDons().TongGiamGiaKhuyenMai_CT(),2)" />
                                        </div>
                                        <div class="flex flex-between" style="flex-wrap:nowrap">
                                            <label>Tổng chiết khấu</label>
                                            <input cclass="input-simple width-75 text-right" readonly
                                                   data-bind="value: formatNumber3Digit(HoaDons().TongGiamGiaHang() + HoaDons().TongGiamGiaKhuyenMai_CT(),2)" />
                                        </div>
                                    </div>
                                </div>
                                <div>
                                    <div class="gara-bill-result">
                                        <label>Thành tiền</label>
                                        <input data-bind="value: formatNumber3Digit(HoaDons().TongTienHang(),2) " readonly />
                                    </div>
                                </div>
                                <div>
                                    <div class="gara-bill-result" data-bind="click: ShowDivTax_HD">
                                        <span>
                                            <span>Thuế</span>
                                            <span data-bind="visible: HoaDons().PTThueHoaDon()> 0, text: '('+  formatNumber3Digit(HoaDons().PTThueHoaDon()) + '%)'">
                                            </span>
                                        </span>
                                        <input data-bind="value: formatNumber3Digit(HoaDons().TongTienThue(),2)" readonly />
                                    </div>
                                    <div class="gara-popup-bill" hidden>
                                        <div class="flex flex-between" style="flex-wrap:nowrap">
                                            <label>Thuế</label>
                                            <div class="flex flex-end">
                                                <div class="flex op-js-css-toggle-option ">
                                                    <a class="gara-VAT-VND" data-bind="click: HD_ClickTaxVND">VND</a>
                                                    <a class="gara-VAT-percent" id="hd_TaxPtram" data-bind="click: HD_ClickTaxPtram">%</a>
                                                </div>
                                                <input class="input-simple width-75 text-right" placeholder="Thuế" onclick="this.select()"
                                                       onkeypress="keypressNumber_limitNumber(event, this)"
                                                       data-bind="value: HoaDons().PTThueHoaDon() > 0 ? formatNumber3Digit(HoaDons().PTThueHoaDon()): formatNumber3Digit(HoaDons().TongTienThue(),2),
   event:{keyup:editTax } " />

                                            </div>
                                        </div>
                                        <div class="flex flex-between" style="flex-wrap:nowrap;"
                                             data-bind="visible: HoaDons().ID_BaoHiem()!==null">
                                            <label>Thuế bảo hiểm</label>
                                            <input class="input-simple width-75 text-right" readonly
                                                   data-bind="value: formatNumber3Digit(HoaDons().TongTienThueBaoHiem(),2)" />
                                        </div>
                                        <div class="flex flex-between" style="flex-wrap:nowrap">
                                            <label>Thuế khách hàng</label>
                                            <input cclass="input-simple width-75 text-right" readonly
                                                   data-bind="value: formatNumber3Digit(HoaDons().TongThueKhachHang(),2)" />
                                        </div>
                                    </div>
                                </div>
                                <div class="position-relative"
                                     data-bind="visible: $root.HoaDons().ID_PhieuTiepNhan() !== null">
                                    <div class="gara-bill-result">
                                        <label class="bold nopadding">
                                            <input type="checkbox" id="isBaoHiem"
                                                   data-bind="checked:  HoaDons().ID_BaoHiem() !== null,
                                                   event:{change: $root.Click_UseBaoHiem}" />
                                            Bảo hiểm
                                        </label>
                                        <input type="text"
                                               data-bind="value: HoaDons().TenBaoHiem(), attr: { title: HoaDons().TenBaoHiem() }" />
                                        @*<label data-bind="attr: { title: HoaDons().TenBaoHiem() }, text: HoaDons().TenBaoHiem()"></label>*@
                                    </div>
                                </div>
                                <div data-bind="visible: $root.HoaDons().ID_BaoHiem() !== null && HoaDons().LoaiHoaDon() === 25">
                                    <div class="gara-bill-result">
                                        <label class="bold">
                                            Bảo hiểm chi trả
                                        </label>
                                        <input placeholder="Giá trị thanh toán" title="Giá trị bảo hiểm phải thanh toán" onclick="this.select()"
                                               onkeypress="return keypressNumber(event)"
                                               data-bind="value: formatNumber3Digit(HoaDons().PhaiThanhToanBaoHiem(),2),
                                               click: showPopupBaoHiem" />
                                    </div>
                                </div>
                                <div data-bind="visible: HoaDons().BaoHiemDaTra()> 0">
                                    <div class="gara-bill-result">
                                        <label>
                                            Bảo hiểm đã trả
                                        </label>
                                        <input readonly data-bind="value: formatNumber3Digit(HoaDons().BaoHiemDaTra(),2)" />
                                    </div>
                                </div>
                                <div>
                                    <div class="gara-bill-result" data-bind="click: ShowDivSale_HD">
                                        <span>
                                            <span>Giảm trừ thanh toán</span>
                                            <span data-bind="visible: HoaDons().TongChietKhau()> 0, text: '('+  formatNumber3Digit(HoaDons().TongChietKhau()) + '%)'"></span>
                                        </span>
                                        <input data-bind="value: formatNumber3Digit(HoaDons().TongGiamGia(),2)" />
                                    </div>
                                    <div class="gara-popup-bill" hidden>
                                        <div class="flex flex-between" style="flex-wrap:nowrap">
                                            <label>Giảm giá</label>
                                            <div class="flex flex-end">
                                                <div class="flex op-js-css-toggle-option ">
                                                    <a class="gara-VAT-VND" data-bind="click: clickVNDPr">VND</a>
                                                    <a class="gara-VAT-percent" id="hd_CKPtram" data-bind="click: clickNoVNDPr">%</a>
                                                </div>
                                                <input class="input-simple width-75 text-right" onclick="this.select()"
                                                       onkeypress="keypressNumber_limitNumber(event, this)"
                                                       data-bind="value: HoaDons().TongChietKhau() > 0 ? formatNumber3Digit(HoaDons().TongChietKhau()): formatNumber3Digit(HoaDons().TongGiamGiaKM_HD(),2),
   event:{keyup:editSalePr}," />

                                            </div>
                                        </div>
                                        <div class="flex flex-between" style="flex-wrap:nowrap;display:none">
                                            <label>Khuyến mại</label>
                                            <input class="input-simple" readonly
                                                   data-bind="value: formatNumber3Digit(HoaDons().KhuyeMai_GiamGia(),2)" />
                                        </div>
                                        <div>
                                            <label>Tổng giảm giá</label>
                                            <input class="input-simple" readonly
                                                   data-bind="value: formatNumber3Digit(HoaDons().TongGiamGiaKM_HD(),2)" />
                                        </div>
                                    </div>
                                </div>


                                <div data-bind="visible: HoaDons().LoaiHoaDon()!==6">
                                    <div class="gara-bill-result">
                                        <label class="bold">
                                            Khách hàng cần trả
                                        </label>
                                        <input readonly
                                               data-bind="value: formatNumber3Digit(HoaDons().PhaiThanhToan(),2)" />
                                    </div>
                                </div>

                                <div class="position-relative">
                                    <div class="gara-bill-result">
                                        <label class="bold" style="width:unset" data-bind="click: $root.showModalChiPhi">
                                            Tổng thanh toán hóa đơn
                                        </label>
                                        <input readonly data-bind="value: formatNumber3Digit(HoaDons().TongThanhToan(),2)" />
                                    </div>
                                </div>
                                <div class="position-relative" style="display:none">
                                    <div class="gara-bill-result">
                                        <label style="width:unset">
                                            Chi phí
                                        </label>
                                        <input readonly data-bind="click:$root.showModalChiPhi" />
                                    </div>
                                </div>
                                <div data-bind="visible: HoaDons().LoaiHoaDon()=== 1 || HoaDons().LoaiHoaDon() === 25">
                                    <div class="gara-bill-result">
                                        <label style="width: unset">
                                            Chi phí
                                        </label>
                                        <input readonly
                                               onclick="this.select()"
                                               data-bind="value: formatNumber3Digit(HoaDons().TongChiPhi(),2),
                                               click:$root.showModalChiPhi" />
                                        <div class="gara-popup-chietkhau">
                                            <div class="gara-bill-result-note">
                                                <i class="material-icons">create</i>
                                                <input placeholder="Ghi chú chi phí"
                                                       data-bind="value: HoaDons().ChiPhi_GhiChu(),    event:{keyup: editGhiChuChiPhi}" />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div data-bind="visible: HoaDons().LoaiHoaDon() == 6 && HoaDons().HoanTraTamUng() <=0">
                                    <div class="gara-bill-result">
                                        <label class="bold">
                                            Khách hàng cần trả
                                        </label>
                                        <input readonly
                                               data-bind="value: formatNumber3Digit(HoaDons().PhaiThanhToan() - HoaDons().TongTienTra(),2)" />
                                    </div>
                                </div>
                                <div data-bind="visible: HoaDons().KhachDaTra()> 0">
                                    <div class="gara-bill-result">
                                        <label>
                                            Khách hàng đã trả
                                        </label>
                                        <input readonly data-bind="value: formatNumber3Digit(HoaDons().KhachDaTra(),2)" />
                                    </div>
                                </div>
                                <div data-bind="visible: HoaDons().SoDuDatCoc()> 0">
                                    <div class="gara-bill-result">
                                        <label class="bold">
                                            Tiền cọc
                                        </label>
                                        <input class="bold" readonly data-bind="value: formatNumber3Digit(HoaDons().SoDuDatCoc(),2)" />
                                    </div>
                                </div>

                                <div data-bind="visible: HoaDons().HoanTraTamUng() > 0 || (HoaDons().PhaiThanhToan() - HoaDons().KhachDaTra() - HoaDons().SoDuDatCoc() < 0)">
                                    <div class="gara-bill-result">
                                        <label>
                                            Cần trả khách
                                        </label>
                                        <input readonly data-bind="value: formatNumber3Digit(HoaDons().HoanTraTamUng(),2)" />
                                    </div>
                                </div>

                                <!--khong hien thong tin tienkhachdua, tienthua tra khach-->
                                <div data-bind="visible: $root.HoaDons().LoaiHoaDon() == 123 && HoaDons().HoanTraTamUng() <=0">
                                    <div class="gara-bill-result">
                                        <label data-bind="click: ShowModalThanhToan">
                                            Tiền khách đưa
                                            <small data-bind="value: formatNumber3Digit(HoaDons().DaThanhToan(),2)">(VNĐ)</small>
                                        </label>
                                        <input onkeypress="return keypressNumber(event)" onclick="this.select()"
                                               data-bind="value: formatNumber3Digit(HoaDons().DaThanhToan(),2), event:{keyup:editDaTra }" />
                                    </div>
                                </div>
                                <div data-bind="visible: $root.HoaDons().LoaiHoaDon() == 123 && HoaDons().HoanTraTamUng() <=0">
                                    <div class="gara-bill-result">
                                        <label data-bind="text: HoaDons().HoanTraTamUng() > 0? (HoaDons().DaTraKhach() >= HoaDons().HoanTraTamUng()?'Tiền thừa':'Đang thiếu khách'): (HoaDons().TienThua() >= 0?'Tiền thừa trả lại khách':'Tiền khách thiếu')">Tiền thừa trả lại khách</label>
                                        <input data-bind="value: formatNumber3Digit(Math.abs(HoaDons().TienThua()),2)" />
                                    </div>
                                </div>
                                <div>
                                    <div class="gara-bill-result">
                                        <i class="material-icons" style="    position: absolute;    top: 7px;    left: 2px;    font-size: 16px;">create</i>
                                        <textarea style="display:block; width:100%; padding-left:30px; text-align:left; resize:none" placeholder="Ghi chú hóa đơn"
                                                  data-bind="value: HoaDons().DienGiai(), event:{keyup: editNote}">
                                        </textarea>
                                    </div>
                                </div>
                                <div class="expiry-date-service container-fluid"
                                     data-bind="visible: $root.HoaDons().LoaiHoaDon()===19">
                                    <div class="form-group floatleft">
                                        <label> Ngày áp dụng:</label>
                                        <div class="form-news ">
                                            <input class="form-control" id="dtNgayApDungGoiDV" autocomplete="off"
                                                   data-bind="click: formatDate, value: HoaDons().NgayApDungGoiDV(),
                                                   event:{change: ChangeNgayApDung_GoiDV}">
                                        </div>
                                    </div>
                                    <div class="form-group floatleft">
                                        <label> Ngày hết hạn:</label>
                                        <div class="form-news  ">
                                            <input class="form-control" id="dtNgayHetHanGoiDV" autocomplete="off"
                                                   data-bind="click: formatDate, value: HoaDons().HanSuDungGoiDV(),
                                                   event:{change: ChangeNgayHetHan_GoiDV}">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!--Xuất kho toàn bộ-->
                    <div class="gara-toggle-line"
                         data-bind="visible: HoaDons().ID_PhieuTiepNhan()!==null && HoaDons().LoaiHoaDon() === 25 ">
                        <span>Xuất kho toàn bộ</span>
                        <div class="gara-togggle-xuatkho"
                             data-bind="css:{'unchecked': HoaDons().XuatKhoAll()===false}">
                            <span data-bind="click: function() {XuatKhoAll_Change(true)}">Có</span>
                            <span data-bind="click: function() {XuatKhoAll_Change(false)}">Không</span>
                        </div>
                    </div>
                    <div class="gara-toggle-line"
                         data-bind="visible: HoaDons().ID_PhieuTiepNhan()!==null
&& HoaDons().LoaiHoaDon() === 3">
                        <span> Duyệt báo giá</span>
                        <div class="gara-togggle-xuatkho"
                             data-bind="css:{'unchecked': HoaDons().DuyetBaoGia()===false}">
                            <span data-bind="click: function() {DuyetBaoGia_Change(true)}">Có</span>
                            <span data-bind="click: function() {DuyetBaoGia_Change(false)}">Không</span>
                        </div>
                    </div>
                </div>
                <div class="gara-bill-executions" id="ListBtnGroupSave">
                    <button title="Lưu" data-bind="click: function() {saveHoaDonTraHang(false)}" id="btnSave">
                        <i class="fa fa-save"></i>
                        <span data-bind="text: HoaDons().LoaiHoaDon()===6?'Trả hàng':'Lưu'">Lưu</span>
                    </button>
                    <!--ko if: HoaDons().TrangThaiHD() ===6 -->
                    <button title="Thanh Toán" data-bind="click: TaoHDDatHang" id="btnTaoHD">
                        <i class="material-icons">money</i>
                        Tạo hóa đơn
                    </button>
                    <!--/ko-->
                    <!--ko if: HoaDons().LoaiHoaDon() !==3-->
                    <button title="Thanh Toán" data-bind="click: $root.ShowModalThanhToan" style="width:50%" id="btnThanhToan">
                        <i class="material-icons">money</i>
                        Thanh toán
                    </button>
                    <!--/ko-->
                    <!--ko if: setPrintDraft()-->
                    <button data-bind="click: InNhap" style="width:25%" id="btnPrintDraft">
                        <i class="fa fa-print"></i>
                        <span>In nháp</span>
                    </button>
                    <!--/ko-->
                </div>
            </div>
        </div>

        <div class="modal fade" id="modalPopuplgDatHang">
            <div class="modal-dialog draggable modal-md  modal-lgmax " role="document">
                @Html.Partial("~/Views/BanHang/_xuliDatHang.cshtml")
            </div>
        </div>
        <div class="modal fade" id="modalPopuplgDelete">
            <div class="modal-dialog draggable modal-md " role="document">
                @Html.Partial("~/Views/GiaoDich/_modalDelete.cshtml")
            </div>
        </div>
        <div class="modal fade bs-example-modal-md" id="getoffline">
            <div class="modal-dialog draggable   modal-lg " role="document">
                @Html.Partial("~/Views/BanHang/_getHoaDonOffline.cshtml")
            </div>
        </div>
        <div class="modal fade" id="modalpopup_endDonDH">
            <div id="modalContainer_delete" class="modal-dialog draggable modal-md" role="document">
                <div class="modal-content">
                    <div class="modal-body">
                        <div class="title-delete">
                            Kết thúc đơn đặt hàng
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><i class="material-icons">close</i></button>
                        </div>
                        Bạn vừa tạo hóa đơn từ đơn đặt hàng. Kết thúc đơn đặt hàng ngay bây giờ?

                    </div>
                    <div class="modal-footer ">
                        <button type="button" class="btn btn-cancel" data-dismiss="modal" data-bind="click: NotEndInvoice">
                            <i class="fa fa-ban"></i>Bỏ qua
                        </button>
                        <button type="button" class="btn btn-main" data-dismiss="modal" data-bind="click: EndInvoice ">
                            <i class="fa fa-check"></i> Đồng ý
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!--import hoadon-->
        <div id="myModalinport" class="modal fade">
            <div class="modal-dialog draggable modal-lg " role="document">
                <div class="modal-content ">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><i class="material-icons">close</i></button>
                        <h4 class="modal-title">Nhập danh sách hàng hóa từ File Excel</h4>
                    </div>
                    <div class="modal-body">
                        <div class="col-sm-12 printinport">
                            <div class="floatleft excel-file " id="importNhapHang">
                                <div data-bind="visible: visibleImport ">
                                    <h5>Nhập hàng hóa từ file Excel - <a href="#" class="link-text" style="float:none;"> Hướng dẫn </a></h5>
                                    <div class="title-inport "> Tải về File mẫu <span class="blue " data-bind="click: DownloadFileTeamplateXLS"> Excel 2003</span>  hoặc<span class="blue" data-bind="click: DownloadFileTeamplateXLSX"> bản cao hơn</span></div>
                                </div>
                                <div class="choose-file">
                                    <span class="btn btn-import ClickSelectFile btn-file form-control no-magrin" data-bind="visible: visibleImport ">
                                        Chọn file dữ liệu
                                        <input type='file' id="imageUploadForm" name="image" data-bind="event:{ change: SelectedFileImport }"
                                               accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel" />
                                    </span>
                                    <div class="list-file flex flex-row" style="margin-bottom:15px">
                                        <ul class="" style="width:calc(100% - 50px)">
                                            <li class="filterFileSelect flex flex-between">
                                                <span data-bind="text: fileNameExcel"></span>
                                                <button class="btn btn-link height-24" data-bind="click: refreshFileSelect">
                                                    <i class="fa fa-close text-danger"></i>
                                                </button>
                                            </li>
                                        </ul>
                                        <button class="btn btn-main height-30 imgUploadClick" alt="Upload" data-bind="visible:notvisibleImport">
                                            <i class="material-icons">folder</i>
                                        </button>
                                    </div>
                                    <div>
                                        <button class="btn btn-main btnImportExcel" id="saveImageFolder" data-bind="click: insertArticleNews"><i class="fa fa-floppy-o"></i> Thực hiện</button>
                                    </div>
                                </div>
                            </div>
                            <div class="warning-content floatleft NoteImport " style="text-align:center">
                                <h5 class="title-alert" style="text-align:center"><i class="fa fa-warning"></i> Lưu ý</h5>
                                <p>Hệ thống hỗ trợ tối đa 10 trang tính (sheet) trên file dữ liệu trong mỗi lần import (mỗi trang tính tương đương một giao dịch)</p>
                            </div>
                        </div>
                        <div class="BangBaoLoi">
                            <div class="error-data">
                                <h4 class="pull-left title">Bảng thông báo lỗi</h4>
                            </div>
                            <div class="table-reponsive table_price table_error">
                                <table class="table  table-hover table-wh">
                                    <thead>
                                        <tr>
                                            <th>Tên Sheet Excel</th>
                                            <th>Vị trí</th>
                                            <th>Thuộc tính</th>
                                            <th>Diễn giải <span class="pull-right red " data-bind="click: ShowandHide"><i class="fa fa-refresh fa-lg" aria-hidden="true"></i></span></th>
                                        </tr>
                                    </thead>
                                    <tbody data-bind="foreach: loiExcel">
                                        <tr>
                                            <td data-bind="text: TenTruongDuLieu"></td>
                                            <td data-bind="text: ViTri"></td>
                                            <td data-bind="text: ThuocTinh"></td>
                                            <td data-bind="text: DienGiai"></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="gara-navigation">
            <a onclick="Navigation(1)" class="BanHangStyle">
                Danh sách
            </a>
            <a onclick="Navigation(2)" class="navi1">
                Thông tin TT
            </a>
        </div>
        <div class="modal fade in">
            <div class="modal-content">
                <div class="modal-body">
                    <ul>
                        <li>
                            <i class="material-icons">add</i>
                            <span>Tạo mới  </span>
                        </li>
                        <li>
                            <i class="material-icons">reply_all</i>
                            <span>Chọn hóa đơn trả hàng</span>
                        </li>
                        <li>
                            <i class="material-icons">business_center</i>
                            <span>Xử lý đặt hàng</span>
                        </li>
                        <li>
                            <i class="material-icons">request_quote</i>
                            <span>Nhập hóa đơn đặt hàng</span>
                        </li>
                        <li>
                            <i class="material-icons">note_add</i>
                            <span>Nhập phiếu thu</span>
                        </li>
                        <li>
                            <i class="material-icons">home</i>
                            <span>Quản lý</span>
                        </li>

                    </ul>
                </div>
            </div>
        </div>
        <div class="op-banhang-mobile-menu flex flex-column" hidden>
            <ul>
                <li>
                    <i class="material-icons">add</i>
                    <span>Tạo mới  </span>
                </li>
                <li>
                    <i class="material-icons">reply_all</i>
                    <span>Chọn hóa đơn trả hàng</span>
                </li>
                <li>
                    <i class="material-icons">business_center</i>
                    <span>Xử lý đặt hàng</span>
                </li>
                <li>
                    <i class="material-icons">request_quote</i>
                    <span>Nhập hóa đơn đặt hàng</span>
                </li>
                <li>
                    <i class="material-icons">note_add</i>
                    <span>Nhập phiếu thu</span>
                </li>
                <li>
                    <i class="material-icons">home</i>
                    <span>Quản lý</span>
                </li>

            </ul>
            <div>
                <button style="" class="btn btn-cancel">
                    Đóng
                </button>
            </div>
        </div>
    </div>

    <div id="partial_product_group">
        <div class="modal fade" id="partialAddProduct">
            <div class="modal-dialog draggable modal-md  " role="document">
                @Html.Partial("~/Views/BanHang/_ThemMoiHangHoaDV.cshtml")
            </div>
        </div>
        <div class="modal" id="partialGroupProduct">
            <div class="modal-dialog draggable modal-md " role="document">
                @Html.Partial("~/Views/BanHang/_ThemNhomHangHoaDV.cshtml")
            </div>
        </div>
    </div>
    <div class="modal fade" id="partialCalendar">
        <div class="modal-dialog draggable modal-md  " role="document">
            @Html.Partial("~/Views/BanHang/_LichHen.cshtml")
        </div>
    </div>
    <script>
        if (location.hostname.indexOf("open24.vn") > 0 || location.hostname === "localhost") {
            var boxloading = `<div class="loading-box">
                                                    <div class="loading-bg">
                                                        <div class="loading-obj">
                                                            <img src="/Content/images/logo-open24-min.png" />
                                                            <div class="inicator-loading">
                                                                <div>
                                                        </div>
                                                </div>
                                            </div>`;
            document.getElementById('btnGoHome').style.display = "block";
        }
        else {
            var boxloading = `<div class="loading-box">
                                                    <div class="loading-bg">
                                                        <div class="loading-obj">
                                                            <div class="inicator-loading">
                                                                <div>
                                                        </div>
                                                </div>
                                            </div>`;
            document.getElementById('btnGoHome').style.display = "none";
        }

        //Thay đổi loading box trên điện thoại nhưng vẫn giữ nguyên trên máy tính
        $('body').gridLoader({ show: true, morewidthheight: 0, iconloading: boxloading });
    </script>
    <script src="@Url.ContentVersioned("~/Scripts/Components/Input.js")"></script>
    <script src="@Url.ContentVersioned("~/Scripts/Components/NhanVien_KhachHang.js")"></script>
    <script src="@Url.ContentVersioned("~/Scripts/Components/HangLoaiXe.js")"></script>
    <script src="@Url.ContentVersioned("~/Scripts/BanHang/ssoft-server-time.js")"></script>
    <script type="text/javascript" src="@Url.ContentVersioned("~/Content/js/Open24FileManager.js")"></script>

    @Html.Partial("~/Views/Gara/_ThongTinThanhToanBaoHiem.cshtml")
    @Html.Partial("~/Views/Gara/HoaDon/_ThuTienHoaDon.cshtml")
    @Html.Partial("~/Views/Gara/HoaDon/_EditHoaHongHD.cshtml")
    @Html.Partial("~/Views/Gara/KhachHang/_ThemNhomKhachHang.cshtml")
    @Html.Partial("~/Views/Gara/KhachHang/_ThemMoiKhachHang.cshtml")
    @Html.Partial("~/Views/Gara/KhachHang/_vmTrangThai_NguonKhach.cshtml")
    @Html.Partial("~/Views/Gara/_ThongTinThanhToanKH.cshtml")
    @Html.Partial("~/Views/Gara/_ThanhPhanDinhLuong.cshtml")
    @Html.Partial("~/Views/Gara/HoaDon/_ThongTinHoaDon.cshtml")
    @Html.Partial("~/Views/Gara/HoaDon/_ThanhPhanCombo.cshtml")
    @Html.Partial("~/Views/Component/_vue-ImageModal.cshtml")
    @Html.Partial("~/Views/Gara/QuanLySuaChua/_TiepNhanXe.cshtml")
    @Html.Partial("~/Views/Gara/QuanLySuaChua/_ThemMoiXe.cshtml")
    @Html.Partial("~/Views/Gara/QuanLySuaChua/_ThemMoiMauXe.cshtml")
    @Html.Partial("~/Views/Gara/QuanLySuaChua/_ThemMoiHangXe.cshtml")
    @Html.Partial("~/Views/Gara/QuanLySuaChua/_ThemMoiLoaiXe.cshtml")
    @Html.Partial("~/Views/Gara/QuanLySuaChua/_NhatKyBaoDuong.cshtml")
    @Html.Partial("~/Views/Gara/_NhatKyGoiBaoDuong.cshtml")
    @Html.Partial("~/Views/BanHang/_trahanghoadon.cshtml")
    @Html.Partial("~/Views/Gara/HoaDon/_ChiPhiHoaDon.cshtml")
    <script src="@Html.WriteRenderFile(Scripts.Url("~/bundles/Gara"))" type="text/javascript"></script>

    <script>
        function openListHoaDon(elm) {
            $(elm).next().toggleClass('expanded');
        }

        function togglefastInput(ele) {
            $('.gara-header-sections .gara-col-left').toggleClass("inputFastMode");
        }
        $(document).mouseup(function (e) {
            var container = $(".gara-popup-chietkhau");
            if (!container.is(e.target) && container.has(e.target).length === 0) {
                container.hide();
            }
        });
        $(document).mouseup(function (e) {
            var container = $(".gara-list-drop");
            if (!container.is(e.target) && container.has(e.target).length === 0) {
                container.hide();
            }
        });

        function showPopupChietKhau(ele) {
            $(ele).siblings(".gara-popup-chietkhau").toggle();
            if (window.innerWidth < 768) {
                $('.bg-op').show();

            } else {

            }
        }
        function ShowNguoiLienHe(ele) {
            $(ele).siblings(".gara-popup-chietkhau").toggle();
        }
        function ShowListChiNhanh(ele) {
            $(ele).siblings(".gara-list-drop").toggle();
        }
        function ShowListBangGia(ele) {
            $(ele).siblings(".gara-list-drop").toggle();
        }
        $(".gara-search-HH").click(
            function () {
                $(this).siblings(".gara-search-dropbox").show();
            });
        $(document).mouseup(function (e) {
            var container = $(".gara-search-dropbox");
            if (!container.is(e.target) && container.has(e.target).length === 0) {
                container.hide();
            }
        });
        $(document).mouseup(function (e) {
            var container = $(".gara-popup-bill");
            if (!container.is(e.target) && container.has(e.target).length === 0) {
                container.hide();
            }
        });
        $(document).mouseup(function (e) {
            var container = $(".popup-detail");
            if (!container.is(e.target) && container.has(e.target).length === 0) {
                container.hide();
            }
        });
        function expand(ele) {
            //nhiều thông tin hơn
            $(ele).hide();
            $(ele).siblings(".gara-expand-button").show();
            $(".bill-main").removeClass("less");
            $(".bill-main").addClass("more");
        }
        function collapse(ele) {
            //ít thông tin hơn
            $(ele).hide();
            $(ele).siblings(".gara-expand-button").show();
            $(".bill-main").removeClass("more");
            $(".bill-main").addClass("less");
        }
        $(document).mouseup(function (e) {
            var container = $(".gara-bill-navigation");
            if ((!container.is(e.target) && container.has(e.target).length === 0) && (window.innerWidth <= 1024)) {
                container.hide();
            }
        });
        function ShowPopupTab() {
            $('.gara-bill-navigation').css('display', 'flex');
        }

        function ToogleReturn() {
            $(".gara-return").toggle();
            $("#Gara_Product").toggle();
            $(".bill-main").removeClass("more");
            $(".bill-main").removeClass("less");
            $(".gara-expand-button").hide();
            $(".gara-expand-.down").show();
        }
        function Navigation(options) {
            function removeSubClass() {
                for (var i = 1; i <= 5; i++) {
                    $(".gara-bill-sections").removeClass("mobile-op-" + i.toString());
                    $("#Gara").removeClass("op-mb-tab-" + i.toString());
                }
            }
            removeSubClass();
            // 1: list hàng hóa đã chọn; 2: thông tin thanh toán; 3: list trả hàng, 4: các hàng hóa có sẵn;
            $(".gara-bill-sections").addClass("mobile-op-" + options.toString());

            $("#Gara").addClass("op-mb-tab-" + options.toString());

        };
        function shownote(ele) {
            $(ele).siblings(".gara-popup-chietkhau").toggle();
        }
        function showpopup(options) {
            $(".popup-detail").show();
            //popup.show();
            $(".popup-detail").addClass(options);
            function rmClass(op) {
                for (var i = 1; i <= 4; i++) {
                    $(".popup-detail").removeClass("arrow-" + i.toString());
                };
                $(".popup-detail").addClass("arrow-" + op.toString());
            }
            switch (options) {
                case 1:
                    rmClass(1)
                    $(".gara-help-button").siblings().hide();
                    $(".gara-help-button").show();
                    break;
                case 2:
                    rmClass(2)
                    $(".gara-help-printer").siblings().hide();
                    $(".gara-help-printer").show();
                    break;
                case 3:
                    rmClass(3)
                    $(".gara-help-user").siblings().hide();
                    $(".gara-help-user").show();
                    break;
                case 4:
                    rmClass(4)
                    $(".gara-help-settings").siblings().hide();
                    $(".gara-help-settings").show();
                    break;
            }
        }
        $(".doitacbaohiem .gara-search-HH").on('click', function () {
            $(".gara-bill-summary").addClass("overflow-visible")
        });
        $(document).mouseup(function (e) {
            var container = $(".doitacbaohiem ");
            if (!container.is(e.target) && container.has(e.target).length === 0) {
            }
            $(".gara-bill-summary").removeClass("overflow-visible");

        });

        $(document).ready(function () {


            if ($("#isBaoHiem").is(":checked") == false) {
                $("#BaoHiemName").attr('disabled', 'disabled');
            } else {
                $("#BaoHiemName").removeAttr('disabled');
            }
            $('#isBaoHiem').on('change', function () {
                let isbaohiem = $("#isBaoHiem").is(":checked");
                if (isbaohiem == false) {
                    $("#BaoHiemName").attr('disabled', 'disabled');
                } else {
                    $("#BaoHiemName").removeAttr('disabled');
                }
            });
            $('.gara-VAT-percent').click(function () {
                $(this).parent().addClass('op-js-toggle-2');
            });
            $('.gara-VAT-VND').click(function () {
                $(this).parent().removeClass('op-js-toggle-2');
            })
        })

        function CopyThisText(ele) {
            var text = $(ele).html();
            $("#CopiedText").val(text);
            $("#CopiedText").select();
            document.execCommand("copy");
            bottomrightnotify('<i class="fa fa-files-o" aria-hidden="true"></i> ' + "Đã sao chép trường " + text, "success");
        }

    </script>
    <script>
        function changeFormularView(opt) {
            let num = $("#formularView > div").length;
            for (i = 1; i <= num; i++) {
                $('#formularView').removeClass('slide-' + i);
            }
            $('#formularView').addClass('slide-' + opt);
        }
        function showpopupbaohiem() {
            $('#popupbaohiem').toggle();
            $('#popupbaohiem').find('input').focus().select();
        }
        $(document).mouseup(function (e) {
            var container = $("#popupbaohiem ");
            if (!container.is(e.target) && container.has(e.target).length === 0) {

                container.hide()
            }


        });

        $(function () {
            setTimeout(function () {
                document.getElementById('Gara').style.visibility = "visible";
                document.getElementById('Gara').style.opacity = "1";
            }, 400);
        });
    </script>
</body>
</html>
